

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Models &mdash; GeoNAT 0.8 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Network" href="network.html" />
    <link rel="prev" title="Earthquakes" href="earthquakes.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> GeoNAT
          

          
          </a>

          
            
            
              <div class="version">
                0.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/tutorial_1.html">Tutorial 1: The first synthetic station</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_1.html#building-a-model-collection">Building a Model collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_1.html#creating-timeseries-objects">Creating Timeseries objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_1.html#fitting-the-models">Fitting the models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_1.html#plotting-the-fit-and-residuals">Plotting the fit and residuals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/tutorial_2.html">Tutorial 2: Advanced Models and Fitting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_2.html#creating-more-complex-synthetic-data">Creating more complex synthetic data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_2.html#spline-models-for-transients">Spline models for transients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_2.html#building-a-network">Building a Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_2.html#fitting-an-entire-network">Fitting an entire network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_2.html#advanced-plotting">Advanced plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_2.html#repeat-with-l2-regularization">Repeat with L2 regularization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_2.html#repeat-with-l1-regularization">Repeat with L1 regularization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_2.html#adding-reweighting-iterations">Adding reweighting iterations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_2.html#comparing-specific-parameters">Comparing specific parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/tutorial_3.html">Tutorial 3: Incorporating Spatial Coherence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#preparations">Preparations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#dreaming-up-a-network">Dreaming up a network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#fantasizing-data">Fantasizing data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#removing-the-common-mode-error">Removing the Common Mode Error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#fitting-the-data-using-reweighted-l1-regularization">Fitting the data using reweighted L1 regularization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#fitting-the-data-using-a-spatially-aware-l1-reweighting">Fitting the data using a spatially-aware L1 reweighting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#finding-unmodeled-jumps">Finding unmodeled jumps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#statistics-of-spatial-reweighting">Statistics of spatial reweighting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#model-parameter-correlations">Model parameter correlations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#transient-visualization-with-worm-plots">Transient visualization with worm plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_3.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/tutorial_4.html">Tutorial 4: The use and estimation of covariance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_4.html#making-a-noisy-network">Making a noisy network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_4.html#fitting-the-models-with-the-spatial-l0-solver">Fitting the models with the spatial L0 solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_4.html#quality-of-the-fits">Quality of the fits</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_4.html#correlation-of-parameters">Correlation of parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_4.html#simple-linear-regression-with-restricted-spline-set">Simple linear regression with restricted spline set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tutorial_4.html#empirical-covariance-estimation">Empirical covariance estimation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/example_1.html">Example 1: Long Valley Caldera Transient Motions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/example_1.html#preparations">Preparations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/example_1.html#getting-data">Getting data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/example_1.html#building-the-network">Building the network</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/example_1.html#cleaning-the-timeseries">Cleaning the timeseries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/example_1.html#outlier-and-cme-removal">Outlier and CME removal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/example_1.html#first-pass-major-steps-and-noisy-periods">First pass: major steps and noisy periods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/example_1.html#second-pass-minor-catalog-based-steps">Second pass: minor, catalog-based steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/example_1.html#model-parameter-estimation">Model parameter estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/example_1.html#comparison-of-secular-velocities">Comparison of secular velocities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/example_1.html#final-considerations">Final considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/example_1.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../geonat.html">GeoNAT</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="compiled.html">Compiled</a><ul>
<li class="toctree-l3"><a class="reference internal" href="compiled.html#maskedmedfilt2d">maskedmedfilt2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiled.html#source-code">Source Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="earthquakes.html">Earthquakes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model-parent-class">Model (Parent Class)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#model-collection">Model Collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-models">Basic Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#arctangent">Arctangent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exponential">Exponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logarithmic">Logarithmic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#polynomial">Polynomial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step">Step</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sinusoidal">Sinusoidal</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#spline-models">Spline Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bspline">BSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ispline">ISpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="#splineset">SplineSet</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="network.html">Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="processing.html">Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="processing.html#unwrap-dict-and-ts">unwrap_dict_and_ts</a></li>
<li class="toctree-l3"><a class="reference internal" href="processing.html#functions">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="processing.html#clean">clean</a></li>
<li class="toctree-l4"><a class="reference internal" href="processing.html#common-mode">common_mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="processing.html#median">median</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="processing.html#classes">Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="processing.html#stepdetector">StepDetector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="solvers.html">Solvers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="solvers.html#local-solver-functions">Local Solver Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="solvers.html#lasso-regression">lasso_regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="solvers.html#linear-regression">linear_regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="solvers.html#ridge-regression">ridge_regression</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="solvers.html#global-solver-classes">Global Solver Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="solvers.html#spatialsolver">SpatialSolver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="solvers.html#solution-object">Solution Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="solvers.html#reweighting-functions">Reweighting Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="solvers.html#reweightingfunction">ReweightingFunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="solvers.html#inversereweighting">InverseReweighting</a></li>
<li class="toctree-l4"><a class="reference internal" href="solvers.html#inversesquaredreweighting">InverseSquaredReweighting</a></li>
<li class="toctree-l4"><a class="reference internal" href="solvers.html#logarithmicreweighting">LogarithmicReweighting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="station.html">Station</a></li>
<li class="toctree-l2"><a class="reference internal" href="timeseries.html">Timeseries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="timeseries.html#timeseries-parent-class">Timeseries (Parent Class)</a></li>
<li class="toctree-l3"><a class="reference internal" href="timeseries.html#specialized-classes">Specialized Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="timeseries.html#gipsytimeseries">GipsyTimeseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="timeseries.html#unrtimeseries">UNRTimeseries</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tools.html#functions">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tools.html#parallelize">parallelize</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#tvec-to-numpycol">tvec_to_numpycol</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#create-powerlaw-noise">create_powerlaw_noise</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#parse-maintenance-table">parse_maintenance_table</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#weighted-median">weighted_median</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#download-unr-data">download_unr_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#parse-unr-steps">parse_unr_steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#get-cov-dims">get_cov_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#make-cov-index-map">make_cov_index_map</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#get-cov-indices">get_cov_indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#full-cov-mat-to-columns">full_cov_mat_to_columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#block-permutation">block_permutation</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#cov2corr">cov2corr</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tools.html#classes">Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tools.html#rinexdataholding">RINEXDataHolding</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#timedelta">Timedelta</a></li>
<li class="toctree-l4"><a class="reference internal" href="tools.html#click">Click</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GeoNAT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../geonat.html">GeoNAT</a> &raquo;</li>
        
      <li>Models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/geonat/models.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-geonat.models">
<span id="models"></span><h1>Models<a class="headerlink" href="#module-geonat.models" title="Permalink to this headline">¶</a></h1>
<p>This module contains all models that can be used to fit the data
or generate synthetic timeseries.</p>
<div class="section" id="model-parent-class">
<h2>Model (Parent Class)<a class="headerlink" href="#model-parent-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.Model">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_before</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for models.</p>
<p>The class implements some common methods as to how one interacts with models, with
the goal that subclasses of it can focus on as few details as possible.</p>
<p>A model, generally speaking, is defined by parameters (and optionally their
covariance), and can be evaluated given a series of timestamps. Most models will
make use of the <a class="reference internal" href="#geonat.models.Model.time_unit" title="geonat.models.Model.time_unit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">time_unit</span></code></a> and <a class="reference internal" href="#geonat.models.Model.t_reference" title="geonat.models.Model.t_reference"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_reference</span></code></a> attributes to relate
time series into data space. Solvers can check the <a class="reference internal" href="#geonat.models.Model.regularize" title="geonat.models.Model.regularize"><code class="xref py py-attr docutils literal notranslate"><span class="pre">regularize</span></code></a> attribute
to regularize the model during fitting.</p>
<p>Models are usually linear (but can be overriden in subclasses), and adhere to the
nomenclature</p>
<div class="math notranslate nohighlight">
\[\mathbf{G}(\mathbf{t}) \cdot \mathbf{m} = \mathbf{d}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{G}\)</span> is the mapping matrix, <span class="math notranslate nohighlight">\(\mathbf{t}\)</span> is the time
vector, <span class="math notranslate nohighlight">\(\mathbf{m}\)</span> are the model parameters, and <span class="math notranslate nohighlight">\(\mathbf{d}\)</span> are
the observations.</p>
<p>Models are always active by default, i.e. they implement a certain functional form
that can be evaluated at any time. By setting the <a class="reference internal" href="#geonat.models.Model.t_start" title="geonat.models.Model.t_start"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_start</span></code></a> and <a class="reference internal" href="#geonat.models.Model.t_end" title="geonat.models.Model.t_end"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_end</span></code></a>
attributes, this behavior can be changed, so that it is only defined on that interval,
and is zero or continuous outside of that interval (see the attributes
<a class="reference internal" href="#geonat.models.Model.zero_before" title="geonat.models.Model.zero_before"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero_before</span></code></a> and <a class="reference internal" href="#geonat.models.Model.zero_after" title="geonat.models.Model.zero_after"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero_after</span></code></a>).</p>
<p>The usual workflow is to instantiate a model, then fit it to a timeseries, saving
the parameters, and then evaluate it later. For synthetic timeseries, it is
instantiated and the parameters are set manually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_parameters</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of model parameters.</p></li>
<li><p><strong>regularize</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, regularization-capable solvers will regularize the
parameters of this model.</p></li>
<li><p><strong>time_unit</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Time unit for parameters.
Refer to <a class="reference internal" href="tools.html#geonat.tools.Timedelta" title="geonat.tools.Timedelta"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timedelta</span></code></a> for more details.</p></li>
<li><p><strong>t_start</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><em>pandas.Timestamp</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.9/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – Sets the model start time (attributes <a class="reference internal" href="#geonat.models.Model.t_start" title="geonat.models.Model.t_start"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_start</span></code></a> and <a class="reference internal" href="#geonat.models.Model.t_start_str" title="geonat.models.Model.t_start_str"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_start_str</span></code></a>).</p></li>
<li><p><strong>t_end</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><em>pandas.Timestamp</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.9/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – Sets the model end time (attributes <a class="reference internal" href="#geonat.models.Model.t_end" title="geonat.models.Model.t_end"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_end</span></code></a> and <a class="reference internal" href="#geonat.models.Model.t_end_str" title="geonat.models.Model.t_end_str"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_end_str</span></code></a>).</p></li>
<li><p><strong>t_reference</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><em>pandas.Timestamp</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.9/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – Sets the model reference time (attributes <a class="reference internal" href="#geonat.models.Model.t_reference" title="geonat.models.Model.t_reference"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_reference</span></code></a>
and <a class="reference internal" href="#geonat.models.Model.t_reference_str" title="geonat.models.Model.t_reference_str"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_reference_str</span></code></a>).</p></li>
<li><p><strong>zero_before</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Defines whether the model is zero before <code class="docutils literal notranslate"><span class="pre">t_start</span></code>, or
if the boundary value should be used (attribute <a class="reference internal" href="#geonat.models.Model.zero_before" title="geonat.models.Model.zero_before"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero_before</span></code></a>).</p></li>
<li><p><strong>zero_after</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Defines whether the model is zero after <code class="docutils literal notranslate"><span class="pre">t_end</span></code>, or
if the boundary value should be used (attribute <a class="reference internal" href="#geonat.models.Model.zero_after" title="geonat.models.Model.zero_after"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero_after</span></code></a>).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model.__eq__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>Special function that allows for the comparison of models based on their
type and architecture, regardless of model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><em>geonat.models.Model</em></a>) – Model to compare to.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">geonat.models</span> <span class="kn">import</span> <span class="n">Step</span><span class="p">,</span> <span class="n">Sinusoidal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step1</span><span class="p">,</span> <span class="n">step2</span> <span class="o">=</span> <span class="n">Step</span><span class="p">([</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">]),</span> <span class="n">Step</span><span class="p">([</span><span class="s2">&quot;2020-01-02&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin1</span><span class="p">,</span> <span class="n">sin2</span> <span class="o">=</span> <span class="n">Sinusoidal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;2020-01-01&quot;</span><span class="p">),</span> <span class="n">Sinusoidal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;2020-01-01&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step1</span> <span class="o">==</span> <span class="n">step2</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin1</span> <span class="o">==</span> <span class="n">sin2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that obviously, the objects themselves are still different:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">step1</span> <span class="ow">is</span> <span class="n">step1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step1</span> <span class="ow">is</span> <span class="n">step2</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geonat.models.Model.get_arch" title="geonat.models.Model.get_arch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_arch</span></code></a></dt><dd><p>Function used to determine the equality.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model.__str__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Special function that returns a readable summary of the Model.
Accessed, for example, by Python’s <code class="docutils literal notranslate"><span class="pre">print()</span></code> built-in function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>info</strong> – Model summary.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model._get_arch">
<span class="sig-name descname"><span class="pre">_get_arch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model._get_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model._get_arch" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass-specific model keyword dictionary.
Must have keys <code class="docutils literal notranslate"><span class="pre">'type'</span></code> and <code class="docutils literal notranslate"><span class="pre">'kw_args'</span></code>, the latter having another
dictionary as value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>arch</strong> – Model keyword dictionary.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model._get_mapping">
<span class="sig-name descname"><span class="pre">_get_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timevector</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model._get_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model._get_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the mapping matrix <span class="math notranslate nohighlight">\(\mathbf{G}\)</span> given a time vector <span class="math notranslate nohighlight">\(\mathbf{t}\)</span>
for the active period. Called inside <a class="reference internal" href="#geonat.models.Model.get_mapping" title="geonat.models.Model.get_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_mapping()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timevector</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><em>pandas.Series</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><em>pandas.DatetimeIndex</em></a>) – <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></a> of <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> or alternatively a
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeIndex</span></code></a> containing the timestamps of each observation.
It can be assumed that only timestamps that are valid (i.e., defined by the model’s
<a class="reference internal" href="#geonat.models.Model.zero_before" title="geonat.models.Model.zero_before"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero_before</span></code></a> and <a class="reference internal" href="#geonat.models.Model.zero_after" title="geonat.models.Model.zero_after"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero_after</span></code></a>).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>numpy.ndarray</strong> – <a class="reference internal" href="#geonat.models.Model.num_parameters" title="geonat.models.Model.num_parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_parameters</span></code></a> columns.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Mapping matrix with the same number of rows as <code class="docutils literal notranslate"><span class="pre">timevector</span></code> and</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timevector</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the model given a time vector (calculates <span class="math notranslate nohighlight">\(\mathbf{d}\)</span>
and its (co)variance, if applicable).</p>
<p>This method ignores the parameters being set invalid by <a class="reference internal" href="#geonat.models.Model.freeze" title="geonat.models.Model.freeze"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freeze()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timevector</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><em>pandas.Series</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><em>pandas.DatetimeIndex</em></a>) – <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></a> of <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> or alternatively a
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeIndex</span></code></a> containing the timestamps of each observation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary with the keys <code class="docutils literal notranslate"><span class="pre">time</span></code> containing the input time vector,
<code class="docutils literal notranslate"><span class="pre">fit</span></code> containing <span class="math notranslate nohighlight">\(\mathbf{d}\)</span>, and <code class="docutils literal notranslate"><span class="pre">var</span></code> containing
the formal variance (or <code class="docutils literal notranslate"><span class="pre">None</span></code>, if not present).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/exceptions.html#RuntimeError" title="(in Python v3.9)"><strong>RuntimeError</strong></a> – If the model parameters have not yet been set with <a class="reference internal" href="#geonat.models.Model.read_parameters" title="geonat.models.Model.read_parameters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_parameters()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model.freeze">
<span class="sig-name descname"><span class="pre">freeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zero_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model.freeze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model.freeze" title="Permalink to this definition">¶</a></dt>
<dd><p>In case some parameters are estimated to be close to zero and should not
be considered in future fits and evaluations, this function “freezes”
the model by setting parameters below the threshold <code class="docutils literal notranslate"><span class="pre">zero_threshold</span></code>
to be invalid. The mask will be kept in <a class="reference internal" href="#geonat.models.Model.active_parameters" title="geonat.models.Model.active_parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">active_parameters</span></code></a>.</p>
<p>Only valid parameters will be used by <a class="reference internal" href="#geonat.models.Model.get_mapping" title="geonat.models.Model.get_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_mapping()</span></code></a> and
<a class="reference internal" href="#geonat.models.Model.evaluate" title="geonat.models.Model.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>zero_threshold</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Model parameters with absolute values below <code class="docutils literal notranslate"><span class="pre">zero_threshold</span></code> will be
set to zero and set inactive. Defaults to <code class="docutils literal notranslate"><span class="pre">1e-10</span></code>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geonat.models.Model.unfreeze" title="geonat.models.Model.unfreeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unfreeze</span></code></a></dt><dd><p>The reverse method.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model.get_active_period">
<span class="sig-name descname"><span class="pre">get_active_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timevector</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model.get_active_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model.get_active_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a time vector, return at each point whether the model is active.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timevector</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><em>pandas.Series</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><em>pandas.DatetimeIndex</em></a>) – <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></a> of <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> or alternatively a
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeIndex</span></code></a> containing the timestamps of each observation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>active</strong> (<em>numpy.ndarray</em>) – Array of same length as <code class="docutils literal notranslate"><span class="pre">timevector</span></code>, with <code class="docutils literal notranslate"><span class="pre">True</span></code> where active.</p></li>
<li><p><strong>first</strong> (<em>int</em>) – Index of the first active timestamp.</p></li>
<li><p><strong>last</strong> (<em>int</em>) – Index of the last active Timestamp.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model.get_arch">
<span class="sig-name descname"><span class="pre">get_arch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model.get_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model.get_arch" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dictionary that describes the model fully and allows it to be recreated.
Requires the model to be subclassed and implement a <a class="reference internal" href="#geonat.models.Model._get_arch" title="geonat.models.Model._get_arch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_arch()</span></code></a> method
that expands the base model keywords to the subclassed model details.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>arch</strong> – Model keyword dictionary.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If the model has not been subclassed and <a class="reference internal" href="#geonat.models.Model._get_arch" title="geonat.models.Model._get_arch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_arch()</span></code></a> has not been added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model.get_mapping">
<span class="sig-name descname"><span class="pre">get_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timevector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_observability</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_active_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model.get_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model.get_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the mapping matrix <span class="math notranslate nohighlight">\(\mathbf{G}\)</span> given a time vector <span class="math notranslate nohighlight">\(\mathbf{t}\)</span>.
Requires the model to be subclassed and implement a <a class="reference internal" href="#geonat.models.Model._get_mapping" title="geonat.models.Model._get_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_mapping()</span></code></a> method.</p>
<p>This method has multiple steps: it first checks the active period of the
model using <a class="reference internal" href="#geonat.models.Model.get_active_period" title="geonat.models.Model.get_active_period"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_active_period()</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">timevector</span></code> is outside the active period,
it skips the actual calculation and returns an empty sparse matrix. If there is at least
one timestamp where the model is active, it calls the actual <a class="reference internal" href="#geonat.models.Model._get_mapping" title="geonat.models.Model._get_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_mapping()</span></code></a>
mapping matrix calculation method only for the timestamps where the model is active in
order to reduce the computational load. Lastly, the dense, evaluated mapping matrix
gets padded before and after with empty sparse matrices (if the model is zero outside
its boundaries) or the values at the boundaries themselves.</p>
<p>This method respects the parameters being set invalid by <a class="reference internal" href="#geonat.models.Model.freeze" title="geonat.models.Model.freeze"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freeze()</span></code></a>, and will
interpret those parameters to be unobservable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timevector</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><em>pandas.Series</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><em>pandas.DatetimeIndex</em></a>) – <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></a> of <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> or alternatively a
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeIndex</span></code></a> containing the timestamps of each observation.</p></li>
<li><p><strong>return_observability</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If true, the function will check if there are any all-zero columns, which
would point to unobservable parameters, and return a boolean mask with the
valid indices.</p></li>
<li><p><strong>ignore_active_parameters</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, do not set inactive parameters to zero to avoid estimation.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mapping</strong> (<em>scipy.sparse.csc_matrix</em>) – Sparse mapping matrix.</p></li>
<li><p><strong>observable</strong> (<em>numpy.ndarray</em>) – Returned if <code class="docutils literal notranslate"><span class="pre">return_observability=True</span></code>.
A boolean NumPy array of the same length as <code class="docutils literal notranslate"><span class="pre">mapping</span></code> has columns.
<code class="docutils literal notranslate"><span class="pre">False</span></code> indicates (close to) all-zero columns (unobservable parameters).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If the model has not been subclassed and <a class="reference internal" href="#geonat.models.Model._get_mapping" title="geonat.models.Model._get_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_mapping()</span></code></a> has not been added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model.read_parameters">
<span class="sig-name descname"><span class="pre">read_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model.read_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model.read_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in the parameters <span class="math notranslate nohighlight">\(\mathbf{m}\)</span> (optionally also their
covariance) and stores them in the instance attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><em>numpy.ndarray</em></a>) – Model parameters of shape
<span class="math notranslate nohighlight">\((\text{num_parameters}, \text{num_components})\)</span>.</p></li>
<li><p><strong>covariances</strong> (<a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Model component (co-)variances that can either have the same shape as
<code class="docutils literal notranslate"><span class="pre">parameters</span></code>, in which case every parameter and component only has a
variance, or it is square with dimensions
<span class="math notranslate nohighlight">\(\text{num_parameters} * \text{num_components}\)</span>, in which case it
represents a full variance-covariance matrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model.tvec_to_numpycol">
<span class="sig-name descname"><span class="pre">tvec_to_numpycol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timevector</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model.tvec_to_numpycol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model.tvec_to_numpycol" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience wrapper for <a class="reference internal" href="tools.html#geonat.tools.tvec_to_numpycol" title="geonat.tools.tvec_to_numpycol"><code class="xref py py-func docutils literal notranslate"><span class="pre">tvec_to_numpycol()</span></code></a> for Model objects that have
the <a class="reference internal" href="#geonat.models.Model.time_unit" title="geonat.models.Model.time_unit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">time_unit</span></code></a> and <a class="reference internal" href="#geonat.models.Model.t_reference" title="geonat.models.Model.t_reference"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_reference</span></code></a> attributes set.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="tools.html#geonat.tools.tvec_to_numpycol" title="geonat.tools.tvec_to_numpycol"><code class="xref py py-func docutils literal notranslate"><span class="pre">tvec_to_numpycol()</span></code></a></dt><dd><p>Convert a Timestamp vector into a NumPy array.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Model.unfreeze">
<span class="sig-name descname"><span class="pre">unfreeze</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Model.unfreeze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Model.unfreeze" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets previous model freezing done by <a class="reference internal" href="#geonat.models.Model.freeze" title="geonat.models.Model.freeze"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freeze()</span></code></a> such that all parameters
are active again.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geonat.models.Model.freeze" title="geonat.models.Model.freeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze</span></code></a></dt><dd><p>The reverse method.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.EVAL_PREDVAR_PRECISION">
<span class="sig-name descname"><span class="pre">EVAL_PREDVAR_PRECISION</span></span><em class="property"> <span class="pre">=</span> <span class="pre">dtype('float32')</span></em><a class="headerlink" href="#geonat.models.Model.EVAL_PREDVAR_PRECISION" title="Permalink to this definition">¶</a></dt>
<dd><p>To reduce memory impact when estimating the full covariance of the predicted
timeseries when calling <a class="reference internal" href="#geonat.models.Model.evaluate" title="geonat.models.Model.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>, this attribute is by default set to
single precision, but can be changed to double precision if desired.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.active_parameters">
<span class="sig-name descname"><span class="pre">active_parameters</span></span><a class="headerlink" href="#geonat.models.Model.active_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>By default, all parameters in the model are considered active, and this attribute is
set to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Otherwise, this attribute contains an array of shape
<span class="math notranslate nohighlight">\((\text{num_parameters}, )\)</span> with <code class="docutils literal notranslate"><span class="pre">True</span></code> where parameters are active, and
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.Model.cov">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">cov</span></span><a class="headerlink" href="#geonat.models.Model.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Square array property with dimensions
<span class="math notranslate nohighlight">\(\text{num_elements} * \text{num_components}\)</span> that contains the parameter’s
full covariance matrix as a NumPy array. The rows (and columns) are ordered such
that they first correspond to the covariances between all components for the first
parameter, then the covariance between all components for the second parameter,
and so forth.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.num_parameters">
<span class="sig-name descname"><span class="pre">num_parameters</span></span><a class="headerlink" href="#geonat.models.Model.num_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of parameters that define the model and can be solved for.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.Model.par">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">par</span></span><a class="headerlink" href="#geonat.models.Model.par" title="Permalink to this definition">¶</a></dt>
<dd><p>Array property of shape <span class="math notranslate nohighlight">\((\text{num_parameters}, \text{num_components})\)</span>
that contains the parameters as a NumPy array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.Model.parameters">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">parameters</span></span><a class="headerlink" href="#geonat.models.Model.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#geonat.models.Model.par" title="geonat.models.Model.par"><code class="xref py py-attr docutils literal notranslate"><span class="pre">par</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.regularize">
<span class="sig-name descname"><span class="pre">regularize</span></span><a class="headerlink" href="#geonat.models.Model.regularize" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicate to solvers to regularize this model (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or not.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.t_end">
<span class="sig-name descname"><span class="pre">t_end</span></span><a class="headerlink" href="#geonat.models.Model.t_end" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> representation of the end time (or <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.t_end_str">
<span class="sig-name descname"><span class="pre">t_end_str</span></span><a class="headerlink" href="#geonat.models.Model.t_end_str" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation of the end time (or <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.t_reference">
<span class="sig-name descname"><span class="pre">t_reference</span></span><a class="headerlink" href="#geonat.models.Model.t_reference" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> representation of the reference time (or <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.t_reference_str">
<span class="sig-name descname"><span class="pre">t_reference_str</span></span><a class="headerlink" href="#geonat.models.Model.t_reference_str" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation of the reference time (or <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.t_start">
<span class="sig-name descname"><span class="pre">t_start</span></span><a class="headerlink" href="#geonat.models.Model.t_start" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> representation of the start time (or <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.t_start_str">
<span class="sig-name descname"><span class="pre">t_start_str</span></span><a class="headerlink" href="#geonat.models.Model.t_start_str" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation of the start time (or <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.time_unit">
<span class="sig-name descname"><span class="pre">time_unit</span></span><a class="headerlink" href="#geonat.models.Model.time_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the time unit of the parameters as a string.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.Model.var">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">var</span></span><a class="headerlink" href="#geonat.models.Model.var" title="Permalink to this definition">¶</a></dt>
<dd><p>Array property of shape <span class="math notranslate nohighlight">\((\text{num_parameters}, \text{num_components})\)</span>
that returns the parameter’s individual variances as a NumPy array.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.zero_after">
<span class="sig-name descname"><span class="pre">zero_after</span></span><a class="headerlink" href="#geonat.models.Model.zero_after" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, model will evaluate to zero after the end time, otherwise the
model value at the end time will be used for all times after that.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Model.zero_before">
<span class="sig-name descname"><span class="pre">zero_before</span></span><a class="headerlink" href="#geonat.models.Model.zero_before" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, model will evaluate to zero before the start time, otherwise the
model value at the start time will be used for all times before that.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="geonat.models.check_model_dict">
<span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">check_model_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#check_model_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.check_model_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a dictionary has the appropriate structure to be used to
create <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>models</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary of structure <code class="docutils literal notranslate"><span class="pre">{model_name:</span> <span class="pre">{&quot;type&quot;:</span> <span class="pre">modelclass,</span> <span class="pre">&quot;kw_args&quot;:</span>
<span class="pre">{**kw_args}}}</span></code> that contains the names, types and necessary keyword arguments
to create each model object.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/exceptions.html#AssertionError" title="(in Python v3.9)"><strong>AssertionError</strong></a> – If the dictionary structure is invalid.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="model-collection">
<h2>Model Collection<a class="headerlink" href="#model-collection" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.ModelCollection">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">ModelCollection</span></span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that contains <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> objects and is mainly used to keep track
of across-model variables and relations such as the cross-model covariances.
It also contains convenience functions that wrap individual models’ functions like
<a class="reference internal" href="#geonat.models.Model.evaluate" title="geonat.models.Model.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>, <a class="reference internal" href="#geonat.models.Model.get_mapping" title="geonat.models.Model.get_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_mapping()</span></code></a>
or <a class="reference internal" href="#geonat.models.Model.read_parameters" title="geonat.models.Model.read_parameters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_parameters()</span></code></a> or attributes like
<a class="reference internal" href="#geonat.models.Model.par" title="geonat.models.Model.par"><code class="xref py py-attr docutils literal notranslate"><span class="pre">par</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.__contains__">
<span class="sig-name descname"><span class="pre">__contains__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_description</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.__contains__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.__contains__" title="Permalink to this definition">¶</a></dt>
<dd><p>Special function that allows to check whether a certain model description
is in the collection.</p>
<p class="rubric">Example</p>
<p>If <code class="docutils literal notranslate"><span class="pre">mc</span></code> is a <a class="reference internal" href="#geonat.models.ModelCollection" title="geonat.models.ModelCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelCollection</span></code></a> instance, and we want to check whether
<code class="docutils literal notranslate"><span class="pre">'mymodel'</span></code> is a model in the collection, the following two are equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># long version</span>
<span class="s1">&#39;mymodel&#39;</span> <span class="ow">in</span> <span class="n">mc</span><span class="o">.</span><span class="n">collection</span>
<span class="c1"># short version</span>
<span class="s1">&#39;mymodel&#39;</span> <span class="ow">in</span> <span class="n">mc</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.__delitem__">
<span class="sig-name descname"><span class="pre">__delitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_description</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.__delitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.__delitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience special function to delete a model contained in
<a class="reference internal" href="#geonat.models.ModelCollection.collection" title="geonat.models.ModelCollection.collection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">collection</span></code></a>. Deleting a model forces the collection’s parameter and
covariance matrices to be reset to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.__eq__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>Special function that allows for the comparison of model collection based on
their contents, regardless of model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#geonat.models.ModelCollection" title="geonat.models.ModelCollection"><em>geonat.models.ModelCollection</em></a>) – Model collection to compare to.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geonat.models.Model.__eq__" title="geonat.models.Model.__eq__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geonat.models.Model.__eq__</span></code></a></dt><dd><p>For more details.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_description</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience special function to the models contained in <a class="reference internal" href="#geonat.models.ModelCollection.collection" title="geonat.models.ModelCollection.collection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">collection</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.__iter__">
<span class="sig-name descname"><span class="pre">__iter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.__iter__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience special function that allows for a shorthand notation to quickly
iterate over all models in <a class="reference internal" href="#geonat.models.ModelCollection.collection" title="geonat.models.ModelCollection.collection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">collection</span></code></a>.</p>
<p class="rubric">Example</p>
<p>If <code class="docutils literal notranslate"><span class="pre">mc</span></code> is a <a class="reference internal" href="#geonat.models.ModelCollection" title="geonat.models.ModelCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelCollection</span></code></a> instance, then the following
two loops are equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># long version</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">mc</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="k">pass</span>
<span class="c1"># shorthand</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">mc</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.__len__" title="Permalink to this definition">¶</a></dt>
<dd><p>Special function that gives quick access to the number of models
in the collection using Python’s built-in <code class="docutils literal notranslate"><span class="pre">len()</span></code> function
to make interactions with iterators easier.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.__setitem__">
<span class="sig-name descname"><span class="pre">__setitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.__setitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.__setitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience special function to add or update a model contained in
<a class="reference internal" href="#geonat.models.ModelCollection.collection" title="geonat.models.ModelCollection.collection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">collection</span></code></a>. Setting or updating a model forces the collection’s
parameter and covariance matrices to be reset to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.__str__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Special function that returns a readable summary of the model collection.
Accessed, for example, by Python’s <code class="docutils literal notranslate"><span class="pre">print()</span></code> built-in function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>info</strong> – Model collection summary.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.build_LS">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">build_LS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_W_G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_data_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_data_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.build_LS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.build_LS" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that builds the necessary matrices to solve the
least-squares problem for the observable parameters given observations.</p>
<p>If the problem only attempts to solve a single data component (by specifying
its index in <code class="docutils literal notranslate"><span class="pre">icomp</span></code>), it simply takes the input mapping matrix <span class="math notranslate nohighlight">\(\mathbf{G}\)</span>,
creates the weight matrix <span class="math notranslate nohighlight">\(\mathbf{W}\)</span>, and computes
<span class="math notranslate nohighlight">\(\mathbf{G}^T \mathbf{W} \mathbf{G}\)</span> as well as
<span class="math notranslate nohighlight">\(\mathbf{G}^T \mathbf{W} \mathbf{d}\)</span>.</p>
<p>If the problem is joint, i.e. there are multiple data components with covariance
between them, this function brodcasts the mapping matrix to the components,
creates the multi-component weight matrix, and then computes those same
<span class="math notranslate nohighlight">\(\mathbf{G}^T \mathbf{W} \mathbf{G}\)</span> and
<span class="math notranslate nohighlight">\(\mathbf{G}^T \mathbf{W} \mathbf{d}\)</span> matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> (<a class="reference external" href="https://docs.scipy.org/doc/scipy-1.6.3/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.6.3)"><em>scipy.sparse.spmatrix</em></a>) – Single-component mapping matrix.</p></li>
<li><p><strong>obs_mask</strong> (<a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><em>numpy.ndarray</em></a>) – Observability mask.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – If provided, the integer index of the component of the data to be fitted.</p></li>
<li><p><strong>return_W_G</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>), also return the <span class="math notranslate nohighlight">\(\mathbf{G}\)</span> and
<span class="math notranslate nohighlight">\(\mathbf{W}\)</span> matrices, reduced to the observable parameters and
given observations.</p></li>
<li><p><strong>use_data_var</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), use the data variance if present. If <code class="docutils literal notranslate"><span class="pre">False</span></code>,
ignore it even if it is present.</p></li>
<li><p><strong>use_data_cov</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), use the data covariance if present. If <code class="docutils literal notranslate"><span class="pre">False</span></code>,
ignore it even if it is present.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>G</strong> (<em>scipy.sparse.spmatrix</em>) – (If <code class="docutils literal notranslate"><span class="pre">return_W_G=True</span></code>.) Reduced <span class="math notranslate nohighlight">\(\mathbf{G}\)</span> matrix.</p></li>
<li><p><strong>W</strong> (<em>scipy.sparse.spmatrix</em>) – (If <code class="docutils literal notranslate"><span class="pre">return_W_G=True</span></code>.) Reduced <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> matrix.</p></li>
<li><p><strong>GtWG</strong> (<em>numpy.ndarray</em>) – Reduced <span class="math notranslate nohighlight">\(\mathbf{G}^T \mathbf{W} \mathbf{G}\)</span> matrix.</p></li>
<li><p><strong>GtWd</strong> (<em>numpy.ndarray</em>) – Reduced <span class="math notranslate nohighlight">\(\mathbf{G}^T \mathbf{W} \mathbf{d}\)</span> matrix.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geonat.models.ModelCollection.prepare_LS" title="geonat.models.ModelCollection.prepare_LS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_LS</span></code></a></dt><dd><p>Function that precedes this one in the regular solving process.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timevector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geonat.models.ModelCollection.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the model given a time vector (calculates <span class="math notranslate nohighlight">\(\mathbf{d}\)</span>
and its (co)variance, if applicable).</p>
<p>This method ignores the parameters being set invalid by <a class="reference internal" href="#geonat.models.ModelCollection.freeze" title="geonat.models.ModelCollection.freeze"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freeze()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timevector</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><em>pandas.Series</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><em>pandas.DatetimeIndex</em></a>) – <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></a> of <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> or alternatively a
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeIndex</span></code></a> containing the timestamps of each observation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary with the keys <code class="docutils literal notranslate"><span class="pre">time</span></code> containing the input time vector,
<code class="docutils literal notranslate"><span class="pre">fit</span></code> containing <span class="math notranslate nohighlight">\(\mathbf{d}\)</span>, and <code class="docutils literal notranslate"><span class="pre">var</span></code> containing
the formal variance (or <code class="docutils literal notranslate"><span class="pre">None</span></code>, if not present).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/exceptions.html#RuntimeError" title="(in Python v3.9)"><strong>RuntimeError</strong></a> – If the model parameters have not yet been set with <a class="reference internal" href="#geonat.models.ModelCollection.read_parameters" title="geonat.models.ModelCollection.read_parameters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_parameters()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.freeze">
<span class="sig-name descname"><span class="pre">freeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.freeze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.freeze" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that calls <a class="reference internal" href="#geonat.models.Model.freeze" title="geonat.models.Model.freeze"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freeze()</span></code></a> for all
models (or a subset thereof) contained in the collection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_list</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), freeze all models. If a list of strings, only
freeze the corresponding models in the collection.</p></li>
<li><p><strong>zero_threshold</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Model parameters with absolute values below <code class="docutils literal notranslate"><span class="pre">zero_threshold</span></code> will be
set to zero and set inactive. Defaults to <code class="docutils literal notranslate"><span class="pre">1e-10</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.from_model_dict">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">from_model_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.from_model_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.from_model_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an empty <a class="reference internal" href="#geonat.models.ModelCollection" title="geonat.models.ModelCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelCollection</span></code></a> object, and adds a dictionary of
model objects to it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_dict</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary with model names as keys, and <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> object instances
as values.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The new <a class="reference internal" href="#geonat.models.ModelCollection" title="geonat.models.ModelCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelCollection</span></code></a> object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#geonat.models.ModelCollection" title="geonat.models.ModelCollection">ModelCollection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.get_arch">
<span class="sig-name descname"><span class="pre">get_arch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.get_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.get_arch" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dictionary that describes the model collection fully and allows it to
be recreated.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>arch</strong> – Model keyword dictionary.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.get_mapping">
<span class="sig-name descname"><span class="pre">get_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timevector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_observability</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_active_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.get_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.get_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the mapping matrix <span class="math notranslate nohighlight">\(\mathbf{G}\)</span> given a time vector <span class="math notranslate nohighlight">\(\mathbf{t}\)</span>
by concatenating the individual mapping matrices from each contained model using
their method <a class="reference internal" href="#geonat.models.Model.get_mapping" title="geonat.models.Model.get_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_mapping()</span></code></a> (see for more details).</p>
<p>This method respects the parameters being set invalid by <a class="reference internal" href="#geonat.models.ModelCollection.freeze" title="geonat.models.ModelCollection.freeze"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freeze()</span></code></a>, and will
interpret those parameters to be unobservable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timevector</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><em>pandas.Series</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><em>pandas.DatetimeIndex</em></a>) – <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></a> of <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> or alternatively a
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeIndex</span></code></a> containing the timestamps of each observation.</p></li>
<li><p><strong>return_observability</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If true, the function will check if there are any all-zero columns, which
would point to unobservable parameters, and return a boolean mask with the
valid indices.</p></li>
<li><p><strong>ignore_active_parameters</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, do not set inactive parameters to zero to avoid estimation.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mapping</strong> (<em>scipy.sparse.csc_matrix</em>) – Sparse mapping matrix.</p></li>
<li><p><strong>observable</strong> (<em>numpy.ndarray</em>) – Returned if <code class="docutils literal notranslate"><span class="pre">return_observability=True</span></code>.
A boolean NumPy array of the same length as <code class="docutils literal notranslate"><span class="pre">mapping</span></code> has columns.
<code class="docutils literal notranslate"><span class="pre">False</span></code> indicates (close to) all-zero columns (unobservable parameters).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.items" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that returns a key-value-iterator from <a class="reference internal" href="#geonat.models.ModelCollection.collection" title="geonat.models.ModelCollection.collection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">collection</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.plot_covariance">
<span class="sig-name descname"><span class="pre">plot_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_corr_coef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_empty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.plot_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.plot_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting method that displays the covariance (or correlation coefficient) matrix.
The axes are labeled by model names for easier interpretation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the title that is added to the figure.</p></li>
<li><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>), the figure is shown interarctively to enable zooming in
etc. If an <code class="docutils literal notranslate"><span class="pre">fname</span></code> is provided, the figure is instead directly saved to the
provided filename.</p></li>
<li><p><strong>use_corr_coef</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – By default (<code class="docutils literal notranslate"><span class="pre">False</span></code>), the method plots the covariance matrix.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the correlation coefficient matrix is plotted instead.</p></li>
<li><p><strong>plot_empty</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – By default (<code class="docutils literal notranslate"><span class="pre">True</span></code>), the full matrix is plotted. If it is sparse, it will be
hard to identify the interplay between the different parameters. Therefore,
setting <code class="docutils literal notranslate"><span class="pre">plot_empty=False</span></code> will only plot the rows and columns corresponding
to nonzero parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.prepare_LS">
<span class="sig-name descname"><span class="pre">prepare_LS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_regularization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reweight_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_internal_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.prepare_LS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.prepare_LS" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that concatenates the mapping matrices of the collection
models given the timevector in in the input timeseries, and returns some
relevant sizes.</p>
<p>It can also combine the regularization masks and reshape the input weights
into the format used by the solvers, optionally taking into account
the internal scales.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> (<a class="reference internal" href="timeseries.html#geonat.timeseries.Timeseries" title="geonat.timeseries.Timeseries"><em>geonat.timeseries.Timeseries</em></a>) – The timeseries whose time indices are used to calculate the mapping matrix.</p></li>
<li><p><strong>include_regularization</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), expands the returned variables (see below) and computes
the regularization mask for the observable parameters only.</p></li>
<li><p><strong>reweight_init</strong> (<a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – Contains the initial weights for the current iteration of the least squares
problem. It can be a Numpy array or a list of Numpy arrays, in which case it
(or the array created by concatenating the list) need to already have the right
output shape (no check is performed). If it is a dictionary, the keys need to be
model names, and the values are then the Numpy arrays which will be arranged
properly to match the mapping matrix.</p></li>
<li><p><strong>use_internal_scales</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>), also return the internal model scales,
subset to the observable and regularized parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>G</strong> (<em>scipy.sparse.spmatrix</em>) – Mapping matrix computed by <a class="reference internal" href="#geonat.models.ModelCollection.get_mapping" title="geonat.models.ModelCollection.get_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_mapping()</span></code></a>.</p></li>
<li><p><strong>obs_mask</strong> (<em>numpy.ndarray</em>) – Observability mask computed by <a class="reference internal" href="#geonat.models.ModelCollection.get_mapping" title="geonat.models.ModelCollection.get_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_mapping()</span></code></a>.</p></li>
<li><p><strong>num_time</strong> (<em>int</em>) – Length of the timeseries.</p></li>
<li><p><strong>num_params</strong> (<em>int</em>) – Number of total parameters present in the model collection.</p></li>
<li><p><strong>num_comps</strong> (<em>int</em>) – Number of components in the timeseries.</p></li>
<li><p><strong>num_obs</strong> (<em>int</em>) – Number of observable parameters.</p></li>
<li><p><strong>num_reg</strong> (<em>int</em>) – (Only if <code class="docutils literal notranslate"><span class="pre">include_regularization=True</span></code>.)
Number of observable and regularized parameters.</p></li>
<li><p><strong>reg_mask</strong> (<em>numpy.ndarray</em>) – (Only if <code class="docutils literal notranslate"><span class="pre">include_regularization=True</span></code>.)
Numpy array of shape <span class="math notranslate nohighlight">\((\text{num_obs}, )\)</span> that for each observable
parameter denotes whether that parameter is regularized (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or not.</p></li>
<li><p><strong>init_weights</strong> (<em>numpy.ndarray</em>) – (Only if <code class="docutils literal notranslate"><span class="pre">include_regularization=True</span></code>.)
Numpy array of shape <span class="math notranslate nohighlight">\((\text{num_reg}, )\)</span> that for each observable
and regularized parameter contains the initial weights.
<code class="docutils literal notranslate"><span class="pre">None</span></code> if <code class="docutils literal notranslate"><span class="pre">reweight_init=None</span></code>.</p></li>
<li><p><strong>weights_scaling</strong> (<em>numpy.ndarray</em>) – (Only if <code class="docutils literal notranslate"><span class="pre">include_regularization=True</span></code>.)
Numpy array of shape <span class="math notranslate nohighlight">\((\text{num_reg}, )\)</span> that for each observable
and regularized parameter contains the internal model scale.
<code class="docutils literal notranslate"><span class="pre">None</span></code> if <code class="docutils literal notranslate"><span class="pre">use_internal_scales=False</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geonat.models.ModelCollection.build_LS" title="geonat.models.ModelCollection.build_LS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_LS</span></code></a></dt><dd><p>Function that follows this one in the regular solving process.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.read_parameters">
<span class="sig-name descname"><span class="pre">read_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.read_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.read_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in the entire collection’s parameters <span class="math notranslate nohighlight">\(\mathbf{m}\)</span> (optionally also
their covariance) and stores them in the instance attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><em>numpy.ndarray</em></a>) – Model collection parameters of shape
<span class="math notranslate nohighlight">\((\text{num_parameters}, \text{num_components})\)</span>.</p></li>
<li><p><strong>covariances</strong> (<a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Model collection component (co-)variances that can either have the same shape
as <code class="docutils literal notranslate"><span class="pre">parameters</span></code>, in which case every parameter and component only has a
variance, or it is square with dimensions
<span class="math notranslate nohighlight">\(\text{num_parameters} * \text{num_components}\)</span>, in which case it
represents a full variance-covariance matrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.unfreeze">
<span class="sig-name descname"><span class="pre">unfreeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ModelCollection.unfreeze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ModelCollection.unfreeze" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that calls <a class="reference internal" href="#geonat.models.Model.unfreeze" title="geonat.models.Model.unfreeze"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unfreeze()</span></code></a> for all
models (or a subset thereof) contained in the collection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_list</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), unfreeze all models. If a list of strings, only
unfreeze the corresponding models in the collection.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.EVAL_PREDVAR_PRECISION">
<span class="sig-name descname"><span class="pre">EVAL_PREDVAR_PRECISION</span></span><em class="property"> <span class="pre">=</span> <span class="pre">dtype('float32')</span></em><a class="headerlink" href="#geonat.models.ModelCollection.EVAL_PREDVAR_PRECISION" title="Permalink to this definition">¶</a></dt>
<dd><p>To reduce memory impact when estimating the full covariance of the predicted
timeseries when calling <a class="reference internal" href="#geonat.models.ModelCollection.evaluate" title="geonat.models.ModelCollection.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>, this attribute is by default set to
single precision, but can be changed to double precision if desired.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.active_parameters">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">active_parameters</span></span><a class="headerlink" href="#geonat.models.ModelCollection.active_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Either <code class="docutils literal notranslate"><span class="pre">None</span></code>, if all parameters are active, or an array of shape
<span class="math notranslate nohighlight">\((\text{num_parameters}, )\)</span> that contains <code class="docutils literal notranslate"><span class="pre">True</span></code> for all active
parameters, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.collection">
<span class="sig-name descname"><span class="pre">collection</span></span><a class="headerlink" href="#geonat.models.ModelCollection.collection" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> objects contained in this collection.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.cov">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">cov</span></span><a class="headerlink" href="#geonat.models.ModelCollection.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Square array property with dimensions
<span class="math notranslate nohighlight">\(\text{num_elements} * \text{num_components}\)</span> that contains the parameter’s
full covariance matrix as a NumPy array. The rows (and columns) are ordered such
that they first correspond to the covariances between all components for the first
parameter, then the covariance between all components for the second parameter,
and so forth.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.covariances">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">covariances</span></span><a class="headerlink" href="#geonat.models.ModelCollection.covariances" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#geonat.models.ModelCollection.cov" title="geonat.models.ModelCollection.cov"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cov</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.internal_scales">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">internal_scales</span></span><a class="headerlink" href="#geonat.models.ModelCollection.internal_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of shape <span class="math notranslate nohighlight">\((\text{num_parameters}, )\)</span> that collects all the
models’ internal scales.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.model_names">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">model_names</span></span><a class="headerlink" href="#geonat.models.ModelCollection.model_names" title="Permalink to this definition">¶</a></dt>
<dd><p>List of all model names.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.num_parameters">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_parameters</span></span><a class="headerlink" href="#geonat.models.ModelCollection.num_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of parameters in the model collection, calculated as the sum of all
the parameters in the contained models.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.num_regularized">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_regularized</span></span><a class="headerlink" href="#geonat.models.ModelCollection.num_regularized" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of all regularized parameters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.par">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">par</span></span><a class="headerlink" href="#geonat.models.ModelCollection.par" title="Permalink to this definition">¶</a></dt>
<dd><p>Array property of shape <span class="math notranslate nohighlight">\((\text{num_parameters}, \text{num_components})\)</span>
that contains the parameters as a NumPy array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.parameters">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">parameters</span></span><a class="headerlink" href="#geonat.models.ModelCollection.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#geonat.models.ModelCollection.par" title="geonat.models.ModelCollection.par"><code class="xref py py-attr docutils literal notranslate"><span class="pre">par</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.regularized_mask">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">regularized_mask</span></span><a class="headerlink" href="#geonat.models.ModelCollection.regularized_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean array mask of shape <span class="math notranslate nohighlight">\((\text{num_parameters}, )\)</span>
where <code class="docutils literal notranslate"><span class="pre">True</span></code> denotes a regularized parameter (<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise``).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ModelCollection.var">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">var</span></span><a class="headerlink" href="#geonat.models.ModelCollection.var" title="Permalink to this definition">¶</a></dt>
<dd><p>Array property of shape <span class="math notranslate nohighlight">\((\text{num_parameters}, \text{num_components})\)</span>
that returns the parameter’s individual variances as a NumPy array.</p>
</dd></dl>

</dd></dl>

<p>Helper class and constant for combined fits of models:</p>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.AllFits">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">AllFits</span></span><a class="reference internal" href="../_modules/geonat/models.html#AllFits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.AllFits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.ALLFITS">
<span class="sig-prename descclassname"><span class="pre">models.</span></span><span class="sig-name descname"><span class="pre">ALLFITS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;geonat.models.AllFits</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#geonat.models.ALLFITS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="basic-models">
<h2>Basic Models<a class="headerlink" href="#basic-models" title="Permalink to this headline">¶</a></h2>
<div class="section" id="arctangent">
<h3>Arctangent<a class="headerlink" href="#arctangent" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.Arctangent">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">Arctangent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_before</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kw_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Arctangent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Arctangent" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<p>This model provides the arctangent <span class="math notranslate nohighlight">\(\arctan(\mathbf{t}/\tau)\)</span>,
stretched with a given time constant and normalized to be between
<span class="math notranslate nohighlight">\((0, 1)\)</span> at the limits.</p>
<p>Because this model is usually transient, it is recommended not to
use it in the estimation of parameters, even when using <code class="docutils literal notranslate"><span class="pre">t_start</span></code>
and <code class="docutils literal notranslate"><span class="pre">t_end</span></code> to make the tails constant (since that introduces high-frequency
artifacts). (Using <code class="docutils literal notranslate"><span class="pre">t_start</span></code> and/or <code class="docutils literal notranslate"><span class="pre">t_end</span></code> might be desirable for creating
syntehtic data, however.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Arctangent time constant <span class="math notranslate nohighlight">\(\tau\)</span>.
It represents the time at which, after zero-crossing at the reference
time, the arctangent reaches the value <span class="math notranslate nohighlight">\(\pi/4\)</span> (before model scaling),
i.e. half of the one-sided amplitude.</p>
</dd>
</dl>
<p>See <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> for attribute descriptions and more keyword arguments.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Arctangent.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><a class="headerlink" href="#geonat.models.Arctangent.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Arctangent time constant.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="exponential">
<h3>Exponential<a class="headerlink" href="#exponential" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.Exponential">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">Exponential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kw_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Exponential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Exponential" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<p>This model provides the “geophysical” exponential <span class="math notranslate nohighlight">\(1-\exp(-\mathbf{t}/\tau)\)</span>
with a given time constant, zero for <span class="math notranslate nohighlight">\(\mathbf{t} &lt; 0\)</span>, and approaching
one asymptotically.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Exponential time constant <span class="math notranslate nohighlight">\(\tau\)</span>.
It represents the amount of time that it takes for the (general) exponential
function’s value to be multiplied by <span class="math notranslate nohighlight">\(e\)</span>.
Applied to this model, for a given relative amplitude <span class="math notranslate nohighlight">\(a\)</span> (so <span class="math notranslate nohighlight">\(0 &lt; a &lt; 1\)</span>,
before model scaling) to be reached at given <span class="math notranslate nohighlight">\(\Delta t\)</span> past <code class="docutils literal notranslate"><span class="pre">t_start</span></code>,
<span class="math notranslate nohighlight">\(\tau = - \frac{\Delta t}{\ln(1 - a)}\)</span></p>
</dd>
</dl>
<p>See <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> for attribute descriptions and more keyword arguments.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Exponential.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><a class="headerlink" href="#geonat.models.Exponential.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Exponential time constant.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="logarithmic">
<h3>Logarithmic<a class="headerlink" href="#logarithmic" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.Logarithmic">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">Logarithmic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kw_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Logarithmic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Logarithmic" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<p>This model provides the “geophysical” logarithmic <span class="math notranslate nohighlight">\(\ln(1 + \mathbf{t}/\tau)\)</span>
with a given time constant and zero for <span class="math notranslate nohighlight">\(\mathbf{t} &lt; 0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Logarithmic time constant <span class="math notranslate nohighlight">\(\tau\)</span>.
It represents the time at which, after zero-crossing at the reference
time, the logarithm reaches the value 1 (before model scaling).</p>
</dd>
</dl>
<p>See <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> for attribute descriptions and more keyword arguments.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Logarithmic.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><a class="headerlink" href="#geonat.models.Logarithmic.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Logarithmic time constant.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="polynomial">
<h3>Polynomial<a class="headerlink" href="#polynomial" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.Polynomial">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">Polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_before</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kw_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<p>Polynomial model of given order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Order (highest exponent) of the polynomial. The number of model parameters
equals <code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">-</span> <span class="pre">min_exponent</span></code>.</p></li>
<li><p><strong>min_exponent</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Lowest exponent of the polynomial. Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>, i.e. the constant offset.</p></li>
</ul>
</dd>
</dl>
<p>See <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> for attribute descriptions and more keyword arguments.</p>
</dd></dl>

</div>
<div class="section" id="step">
<h3>Step<a class="headerlink" href="#step" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.Step">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">Step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steptimes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kw_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Step" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<p>Model that introduces steps at discrete times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>steptimes</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of datetime-like strings that can be converted into <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a>.
Length of it equals the number of model parameters.</p>
</dd>
</dl>
<p>See <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> for attribute descriptions and more keyword arguments.</p>
<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Step.add_step">
<span class="sig-name descname"><span class="pre">add_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Step.add_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Step.add_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a step to the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Datetime-like string of the step time to add</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.Step.remove_step">
<span class="sig-name descname"><span class="pre">remove_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Step.remove_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Step.remove_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a step from the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Datetime-like string of the step time to remove</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Step.steptimes">
<span class="sig-name descname"><span class="pre">steptimes</span></span><a class="headerlink" href="#geonat.models.Step.steptimes" title="Permalink to this definition">¶</a></dt>
<dd><p>List of step times as datetime-like strings.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Step.timestamps">
<span class="sig-name descname"><span class="pre">timestamps</span></span><a class="headerlink" href="#geonat.models.Step.timestamps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of step times as <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sinusoidal">
<h3>Sinusoidal<a class="headerlink" href="#sinusoidal" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.Sinusoidal">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">Sinusoidal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kw_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#Sinusoidal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.Sinusoidal" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<p>This model provides a sinusoidal of a fixed period, with amplitude and phase
to be fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>period</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Period length in <a class="reference internal" href="#geonat.models.Model.time_unit" title="geonat.models.Model.time_unit"><code class="xref py py-attr docutils literal notranslate"><span class="pre">time_unit</span></code></a> units.</p>
</dd>
</dl>
<p>See <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> for attribute descriptions and more keyword arguments.</p>
<p class="rubric">Notes</p>
<p>Implements the relationship</p>
<div class="math notranslate nohighlight">
\[\mathbf{g}(\mathbf{t}) =
a \cos ( 2 \pi \mathbf{t} / T ) + b \sin ( 2 \pi \mathbf{t} / T )\]</div>
<p>with <a class="reference internal" href="#geonat.models.Sinusoidal.period" title="geonat.models.Sinusoidal.period"><code class="xref py py-attr docutils literal notranslate"><span class="pre">period</span></code></a> <span class="math notranslate nohighlight">\(T\)</span>, <a class="reference internal" href="#geonat.models.Sinusoidal.phase" title="geonat.models.Sinusoidal.phase"><code class="xref py py-attr docutils literal notranslate"><span class="pre">phase</span></code></a> <span class="math notranslate nohighlight">\(\phi=\text{atan2}(b,a)\)</span>
and <a class="reference internal" href="#geonat.models.Sinusoidal.amplitude" title="geonat.models.Sinusoidal.amplitude"><code class="xref py py-attr docutils literal notranslate"><span class="pre">amplitude</span></code></a> <span class="math notranslate nohighlight">\(A=\sqrt{a^2 + b^2}\)</span>.</p>
<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.Sinusoidal.amplitude">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">amplitude</span></span><a class="headerlink" href="#geonat.models.Sinusoidal.amplitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Amplitude of the sinusoid.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.Sinusoidal.period">
<span class="sig-name descname"><span class="pre">period</span></span><a class="headerlink" href="#geonat.models.Sinusoidal.period" title="Permalink to this definition">¶</a></dt>
<dd><p>Period of the sinusoid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.Sinusoidal.phase">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">phase</span></span><a class="headerlink" href="#geonat.models.Sinusoidal.phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Phase of the sinusoid.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="spline-models">
<h2>Spline Models<a class="headerlink" href="#spline-models" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bspline">
<h3>BSpline<a class="headerlink" href="#bspline" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.BSpline">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">BSpline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_splines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kw_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#BSpline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.BSpline" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<p>Model defined by cardinal, centralized B-Splines of certain order/degree and time scale.
Used for transient temporary signals that return to zero after a given time span.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>degree</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Degree of the B-Splines.</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Scale of the B-Splines, see Notes.</p></li>
<li><p><strong>t_reference</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><em>pandas.Timestamp</em></a>) – Reference (center) time for (first) spline.</p></li>
<li><p><strong>time_unit</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Time unit of scale, spacing and model parameters.</p></li>
<li><p><strong>num_splines</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of splines, separated by <code class="docutils literal notranslate"><span class="pre">spacing</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>spacing</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Spacing between the center times when multiple splines are created.
Defaults to <code class="docutils literal notranslate"><span class="pre">scale</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>See <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> for attribute descriptions and more keyword arguments.</p>
<p class="rubric">Notes</p>
<p>For an analytic representation of the B-Splines, see <a class="reference internal" href="#butzer88" id="id1"><span>[butzer88]</span></a> or <a class="reference internal" href="#schoenberg73" id="id2"><span>[schoenberg73]</span></a>.
Further examples can be found at <a class="reference external" href="https://bsplines.org/flavors-and-types-of-b-splines/">https://bsplines.org/flavors-and-types-of-b-splines/</a>.</p>
<p>It is important to note that the function will be non-zero on the interval</p>
<div class="math notranslate nohighlight">
\[-(p+1)/2 &lt; x &lt; (p+1)/2\]</div>
<p>where <span class="math notranslate nohighlight">\(p\)</span> is the degree of the cardinal B-spline (and the degree of the
resulting polynomial). The order <span class="math notranslate nohighlight">\(n\)</span> is related to the degree by the relation
<span class="math notranslate nohighlight">\(n = p + 1\)</span>. The scale determines the width of the spline in the time domain,
and corresponds to the interval [0, 1] of the B-Spline. The full non-zero time span
of the spline is therefore <span class="math notranslate nohighlight">\(\text{scale} \cdot (p+1) = \text{scale} \cdot n\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">num_splines</span></code> will increase the number of splines by shifting the reference
point <span class="math notranslate nohighlight">\((\text{num_splines} - 1)\)</span> times by the spacing (which must be given
in the same units as the scale).</p>
<p>If no spacing is given but multiple splines are requested, the scale will be used
as the spacing.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="butzer88"><span class="brackets"><a class="fn-backref" href="#id1">butzer88</a></span></dt>
<dd><p>Butzer, P., Schmidt, M., &amp; Stark, E. (1988).
<em>Observations on the History of Central B-Splines.</em>
Archive for History of Exact Sciences, 39(2), 137-156. Retrieved May 14, 2020,
from <a class="reference external" href="https://www.jstor.org/stable/41133848">https://www.jstor.org/stable/41133848</a></p>
</dd>
<dt class="label" id="schoenberg73"><span class="brackets"><a class="fn-backref" href="#id2">schoenberg73</a></span></dt>
<dd><p>Schoenberg, I. J. (1973). <em>Cardinal Spline Interpolation.</em>
Society for Industrial and Applied Mathematics.
doi:<a class="reference external" href="https://doi.org/10.1137/1.9781611970555">10.1137/1.9781611970555</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.BSpline.get_transient_period">
<span class="sig-name descname"><span class="pre">get_transient_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timevector</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#BSpline.get_transient_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.BSpline.get_transient_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a mask-like array of where each spline is currently transient
(not staying constant).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timevector</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><em>pandas.Series</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><em>pandas.DatetimeIndex</em></a>) – <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></a> of <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> or alternatively a
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeIndex</span></code></a> containing the timestamps of each observation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>transient</strong> – NumPy array with <code class="docutils literal notranslate"><span class="pre">True</span></code> when a spline is currently transient,
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.BSpline.centertimes">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">centertimes</span></span><a class="headerlink" href="#geonat.models.BSpline.centertimes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></a> with all center times.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.BSpline.degree">
<span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#geonat.models.BSpline.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree <span class="math notranslate nohighlight">\(p\)</span> of the B-Splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.BSpline.order">
<span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#geonat.models.BSpline.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Order <span class="math notranslate nohighlight">\(n=p+1\)</span> of the B-Splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.BSpline.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><a class="headerlink" href="#geonat.models.BSpline.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale of the splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.BSpline.spacing">
<span class="sig-name descname"><span class="pre">spacing</span></span><a class="headerlink" href="#geonat.models.BSpline.spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacing between the center times of the splines.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="ispline">
<h3>ISpline<a class="headerlink" href="#ispline" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.ISpline">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">ISpline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_splines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_kw_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ISpline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ISpline" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<p>Integral of cardinal, centralized B-Splines of certain order/degree and time scale,
with an amplitude of 1.
The degree <span class="math notranslate nohighlight">\(p\)</span> given in the initialization is the degree of the spline
<em>before</em> the integration, i.e. the resulting ISpline is a piecewise polynomial
of degree <span class="math notranslate nohighlight">\(p + 1\)</span>. Used for transient permanent signals that stay at their
maximum value after a given time span.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geonat.models.BSpline" title="geonat.models.BSpline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geonat.models.BSpline</span></code></a></dt><dd><p>More details about B-Splines.</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.ISpline.get_transient_period">
<span class="sig-name descname"><span class="pre">get_transient_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timevector</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#ISpline.get_transient_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.ISpline.get_transient_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a mask-like array of where each spline is currently transient
(not staying constant).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timevector</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><em>pandas.Series</em></a><em>, </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><em>pandas.DatetimeIndex</em></a>) – <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></a> of <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a> or alternatively a
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeIndex</span></code></a> containing the timestamps of each observation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>transient</strong> – NumPy array with <code class="docutils literal notranslate"><span class="pre">True</span></code> when a spline is currently transient, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geonat.models.ISpline.centertimes">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">centertimes</span></span><a class="headerlink" href="#geonat.models.ISpline.centertimes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></a> with all center times.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.ISpline.degree">
<span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#geonat.models.ISpline.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree <span class="math notranslate nohighlight">\(p\)</span> of the B-Splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.ISpline.order">
<span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#geonat.models.ISpline.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Order <span class="math notranslate nohighlight">\(n=p+1\)</span> of the B-Splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.ISpline.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><a class="headerlink" href="#geonat.models.ISpline.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale of the splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.ISpline.spacing">
<span class="sig-name descname"><span class="pre">spacing</span></span><a class="headerlink" href="#geonat.models.ISpline.spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacing between the center times of the splines.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="splineset">
<h3>SplineSet<a class="headerlink" href="#splineset" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="geonat.models.SplineSet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geonat.models.</span></span><span class="sig-name descname"><span class="pre">SplineSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">degree</span></em>, <em class="sig-param"><span class="pre">t_center_start</span></em>, <em class="sig-param"><span class="pre">t_center_end</span></em>, <em class="sig-param"><span class="pre">time_unit='D'</span></em>, <em class="sig-param"><span class="pre">list_scales=None</span></em>, <em class="sig-param"><span class="pre">list_num_knots=None</span></em>, <em class="sig-param"><span class="pre">splineclass=&lt;class</span> <span class="pre">'geonat.models.ISpline'&gt;</span></em>, <em class="sig-param"><span class="pre">complete=True</span></em>, <em class="sig-param"><span class="pre">internal_scaling=True</span></em>, <em class="sig-param"><span class="pre">regularize=True</span></em>, <em class="sig-param"><span class="pre">**model_kw_args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#SplineSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.SplineSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<p>Contains a list of splines that share a common degree, but different center
times and scales.</p>
<p>The set is constructed from a time span (<code class="docutils literal notranslate"><span class="pre">t_center_start</span></code> and <code class="docutils literal notranslate"><span class="pre">t_center_end</span></code>)
and numbers of centerpoints or length scales. By default (<code class="docutils literal notranslate"><span class="pre">complete=True</span></code>),
the number of splines and center points for each scale will then be chosen such
that the resulting set of splines will be complete over the input time scale.
This means it will contain all splines that are non-zero at least somewhere in
the time span. Otherwise, the spline set will only have center times at or
between <code class="docutils literal notranslate"><span class="pre">t_center_start</span></code> and <code class="docutils literal notranslate"><span class="pre">t_center_end</span></code>.</p>
<p>This class also sets the spacing equal to the scale.</p>
<p>Lastly, in order to influence the tradeoff between splines of different timescales,
the mapping matrix of each spline is scaled by its own time scale to promote using
fewer components. Without this, there would be an ambiguity for the solver as to
whether fit the signal using many smaller scales or with one large scale, as the
fit would be almost identical. This behavior can be disabled by setting
<code class="docutils literal notranslate"><span class="pre">internal_scaling=False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>degree</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Degree of the splines to be created.</p></li>
<li><p><strong>t_center_start</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><em>pandas.Timestamp</em></a>) – Time span start of the spline set.</p></li>
<li><p><strong>t_center_end</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v1.2.4)"><em>pandas.Timestamp</em></a>) – Time span end of the spline set.</p></li>
<li><p><strong>time_unit</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Time unit of scale, spacing and model parameters.</p></li>
<li><p><strong>list_scales</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of scales to use for each of the sub-splines.
Mutually exclusive to setting <code class="docutils literal notranslate"><span class="pre">list_num_knots</span></code>.</p></li>
<li><p><strong>list_num_knots</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of number of knots to divide the time span into for each of the sub-splines.
Mutually exclusive to setting <code class="docutils literal notranslate"><span class="pre">list_scales</span></code>.</p></li>
<li><p><strong>splineclass</strong> (<a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><em>Model</em></a><em>, </em><em>optional</em>) – Model class to use for the splines. Defaults to <a class="reference internal" href="#geonat.models.ISpline" title="geonat.models.ISpline"><code class="xref py py-class docutils literal notranslate"><span class="pre">ISpline</span></code></a>.</p></li>
<li><p><strong>complete</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – See usage description. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>internal_scaling</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – See usage description. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>See <a class="reference internal" href="#geonat.models.Model" title="geonat.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> for attribute descriptions and more keyword arguments.</p>
<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.SplineSet.freeze">
<span class="sig-name descname"><span class="pre">freeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zero_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#SplineSet.freeze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.SplineSet.freeze" title="Permalink to this definition">¶</a></dt>
<dd><p>In case some parameters are estimated to be close to zero and should not
be considered in future fits and evaluations, this function “freezes”
the model by setting parameters below the threshold <code class="docutils literal notranslate"><span class="pre">zero_threshold</span></code>
to be invalid. The mask will be kept in
<a class="reference internal" href="#geonat.models.Model.active_parameters" title="geonat.models.Model.active_parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">active_parameters</span></code></a>.</p>
<p>Only valid parameters will be used by <a class="reference internal" href="#geonat.models.Model.get_mapping" title="geonat.models.Model.get_mapping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_mapping()</span></code></a> and
<a class="reference internal" href="#geonat.models.Model.evaluate" title="geonat.models.Model.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>zero_threshold</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Model parameters with absolute values below <code class="docutils literal notranslate"><span class="pre">zero_threshold</span></code> will be
set inactive. Defaults to <code class="docutils literal notranslate"><span class="pre">1e-10</span></code>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geonat.models.SplineSet.unfreeze" title="geonat.models.SplineSet.unfreeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unfreeze</span></code></a></dt><dd><p>The reverse method.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.SplineSet.make_scalogram">
<span class="sig-name descname"><span class="pre">make_scalogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmaprange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_param_mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#SplineSet.make_scalogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.SplineSet.make_scalogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a scalogram figure of the model parameters.</p>
<p>A scalogram shows the amplitude of each model parameter plotted over time and
for all the different scales contained. Model parameters that have overlapping
influence are also shown as overlapping. The height of each parameter’s patch
is defined by the weight of that parameter relative to the other parameters
(excluding splines that are not transient at that time).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_left</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Left boundary of the time axis.</p></li>
<li><p><strong>t_right</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Right boundary of the time axis.</p></li>
<li><p><strong>cmaprange</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum absolute amplitude of the color scale to use.
Defaults to the 95th percentile of the absolute amplitudes of all parameters.</p></li>
<li><p><strong>resolution</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of points inside the time span to evaluate the scalogram at.</p></li>
<li><p><strong>min_param_mag</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – The absolute value under which any value is plotted as zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – Figure object of the scalogram.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – Axes object of the scalogram.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If the generation method for the scalogram given the SplineSet’s
    spline class is not defined in this method yet.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.SplineSet.read_parameters">
<span class="sig-name descname"><span class="pre">read_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#SplineSet.read_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.SplineSet.read_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in the parameters <span class="math notranslate nohighlight">\(\mathbf{m}\)</span> (optionally also their variances)
of all the sub-splines and stores them in the respective attributes.</p>
<p>Note that the main <code class="docutils literal notranslate"><span class="pre">SplineSet</span></code> object will still contain all the cross-spline
covariances (if contained in <code class="docutils literal notranslate"><span class="pre">covariances</span></code>), but the sub-splines cannot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><em>numpy.ndarray</em></a>) – Model parameters of shape
<span class="math notranslate nohighlight">\((\text{num_parameters}, \text{num_components})\)</span>.</p></li>
<li><p><strong>covariances</strong> (<a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Model component (co-)variances that can either have the same shape as
<code class="docutils literal notranslate"><span class="pre">parameters</span></code>, in which case every parameter and component only has a
variance, or it is square with dimensions
<span class="math notranslate nohighlight">\(\text{num_parameters} * \text{num_components}\)</span>, in which case it
represents a full variance-covariance matrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonat.models.SplineSet.unfreeze">
<span class="sig-name descname"><span class="pre">unfreeze</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geonat/models.html#SplineSet.unfreeze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonat.models.SplineSet.unfreeze" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets previous model freezing done by <a class="reference internal" href="#geonat.models.SplineSet.freeze" title="geonat.models.SplineSet.freeze"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freeze()</span></code></a> such that all parameters
are active again.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.complete">
<span class="sig-name descname"><span class="pre">complete</span></span><a class="headerlink" href="#geonat.models.SplineSet.complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets whether the spline coverage of the time span is considered to be complete or not
(see class documentation).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.degree">
<span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#geonat.models.SplineSet.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.internal_scales">
<span class="sig-name descname"><span class="pre">internal_scales</span></span><a class="headerlink" href="#geonat.models.SplineSet.internal_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="#geonat.models.SplineSet.internal_scaling" title="geonat.models.SplineSet.internal_scaling"><code class="xref py py-attr docutils literal notranslate"><span class="pre">internal_scaling</span></code></a> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, this NumPy array holds the relative
scaling factors of all parameters over all the sub-splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.internal_scaling">
<span class="sig-name descname"><span class="pre">internal_scaling</span></span><a class="headerlink" href="#geonat.models.SplineSet.internal_scaling" title="Permalink to this definition">¶</a></dt>
<dd><p>Trackes whether to scale the sub-splines relative to their lengths.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.list_num_knots">
<span class="sig-name descname"><span class="pre">list_num_knots</span></span><a class="headerlink" href="#geonat.models.SplineSet.list_num_knots" title="Permalink to this definition">¶</a></dt>
<dd><p>List of number of knots the time span is divided into for each of the sub-splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.list_scales">
<span class="sig-name descname"><span class="pre">list_scales</span></span><a class="headerlink" href="#geonat.models.SplineSet.list_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>List of scales of each of the sub-splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.min_scale">
<span class="sig-name descname"><span class="pre">min_scale</span></span><a class="headerlink" href="#geonat.models.SplineSet.min_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum scale of the sub-splines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.splineclass">
<span class="sig-name descname"><span class="pre">splineclass</span></span><a class="headerlink" href="#geonat.models.SplineSet.splineclass" title="Permalink to this definition">¶</a></dt>
<dd><p>Class of the splines contained.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.splines">
<span class="sig-name descname"><span class="pre">splines</span></span><a class="headerlink" href="#geonat.models.SplineSet.splines" title="Permalink to this definition">¶</a></dt>
<dd><p>List of spline object contained within the SplineSet.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.t_center_end">
<span class="sig-name descname"><span class="pre">t_center_end</span></span><a class="headerlink" href="#geonat.models.SplineSet.t_center_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Relevant time span end.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonat.models.SplineSet.t_center_start">
<span class="sig-name descname"><span class="pre">t_center_start</span></span><a class="headerlink" href="#geonat.models.SplineSet.t_center_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Relevant time span start.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="network.html" class="btn btn-neutral float-right" title="Network" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="earthquakes.html" class="btn btn-neutral float-left" title="Earthquakes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Tobias Köhne.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>