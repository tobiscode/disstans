<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>disstans.station &mdash; DISSTANS 2.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation &amp; Updates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#minimal-installation">Minimal installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#full-development-installation">Full development installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#updates">Updates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_1.html">Tutorial 1: The first synthetic station</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_1.html#building-a-model-collection">Building a Model collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_1.html#creating-timeseries-objects">Creating Timeseries objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_1.html#fitting-the-models">Fitting the models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_1.html#plotting-the-fit-and-residuals">Plotting the fit and residuals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_2.html">Tutorial 2: Advanced Models and Fitting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_2.html#creating-more-complex-synthetic-data">Creating more complex synthetic data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_2.html#spline-models-for-transients">Spline models for transients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_2.html#building-a-network">Building a Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_2.html#fitting-an-entire-network">Fitting an entire network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_2.html#advanced-plotting">Advanced plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_2.html#repeat-with-l2-regularization">Repeat with L2 regularization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_2.html#repeat-with-l1-regularization">Repeat with L1 regularization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_2.html#repeat-with-l0-regularization">Repeat with L0 regularization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_2.html#comparing-specific-parameters">Comparing specific parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_3.html">Tutorial 3: Incorporating Spatial Coherence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#preparations">Preparations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#dreaming-up-a-network">Dreaming up a network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#fantasizing-data">Fantasizing data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#removing-the-common-mode-error">Removing the Common Mode Error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#fitting-the-data-using-reweighted-l1-regularization">Fitting the data using reweighted L1 regularization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#fitting-the-data-using-a-spatially-aware-l1-reweighting">Fitting the data using a spatially-aware L1 reweighting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#finding-unmodeled-jumps">Finding unmodeled jumps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#statistics-of-spatial-reweighting">Statistics of spatial reweighting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#model-parameter-correlations">Model parameter correlations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#transient-visualization-with-worm-plots">Transient visualization with worm plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_3.html#secular-velocity-comparisons">Secular velocity comparisons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_4.html">Tutorial 4: The use and estimation of covariance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_4.html#making-a-noisy-network">Making a noisy network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_4.html#fitting-the-models-with-the-spatial-l0-solver">Fitting the models with the spatial L0 solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_4.html#quality-of-the-fits">Quality of the fits</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_4.html#correlation-of-parameters">Correlation of parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_4.html#simple-linear-regression-with-restricted-spline-set">Simple linear regression with restricted spline set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_4.html#empirical-covariance-estimation">Empirical covariance estimation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_5.html">Tutorial 5: Signal Recovery at Low SNR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_5.html#preparations">Preparations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_5.html#defining-the-variables-and-hyperparameter-space">Defining the variables and hyperparameter space</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_5.html#running-test-cases">Running test cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tutorial_5.html#results">Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/example_1.html">Example 1: Long Valley Caldera Transient Motions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_1.html#preparations">Preparations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/example_1.html#getting-data">Getting data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/example_1.html#building-the-network">Building the network</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_1.html#cleaning-the-timeseries">Cleaning the timeseries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/example_1.html#outlier-and-cme-removal">Outlier and CME removal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/example_1.html#first-pass-major-steps-and-noisy-periods">First pass: major steps and noisy periods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/example_1.html#second-pass-minor-catalog-based-steps">Second pass: minor, catalog-based steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_1.html#model-parameter-estimation">Model parameter estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_1.html#modeled-horizontal-transient-motion">Modeled horizontal transient motion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_1.html#modeled-vertical-seasonal-motion">Modeled vertical seasonal motion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_1.html#comparison-of-secular-velocities">Comparison of secular velocities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_1.html#final-considerations">Final considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_1.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/example_2.html">Example 2: Long Valley Caldera Comparisons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_2.html#preparations">Preparations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_2.html#homogenous-translation-rotation-and-strain">Homogenous translation, rotation, and strain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_2.html#rotation-about-an-euler-pole">Rotation about an Euler pole</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_2.html#comparison-of-different-methods">Comparison of different methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_2.html#loading-other-different-datasets">Loading other different datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_2.html#north-american-reference-frame">North American reference frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_2.html#estimate-euler-poles-for-datasets">Estimate Euler poles for datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_2.html#map-view-comparison-of-datasets">Map view comparison of datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_2.html#quantitative-comparison-of-datasets">Quantitative comparison of datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/example_2.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../faq.html#how-do-i-know-which-penalties-to-use-in-subst">1. How do I know which penalties to use in <code class="xref py py-func docutils literal notranslate"><span class="pre">lasso_regression()</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">ReweightingFunction</span></code>?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq.html#how-can-i-save-my-network-object-to-save-time">2. How can I save my <code class="xref py py-class docutils literal notranslate"><span class="pre">Network</span></code> object to save time?</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../disstans.html">DISSTANS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../disstans/compiled.html">Compiled</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/compiled.html#selectpair">selectpair</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/compiled.html#disstans.compiled.selectpair"><code class="docutils literal notranslate"><span class="pre">selectpair()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/compiled.html#source-code">Source Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../disstans/config.html">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/config.html#disstans.config.defaults"><code class="docutils literal notranslate"><span class="pre">config.defaults</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../disstans/earthquakes.html">Earthquakes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/earthquakes.html#disstans.earthquakes.okada_displacement"><code class="docutils literal notranslate"><span class="pre">okada_displacement()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/earthquakes.html#disstans.earthquakes.okada_prior"><code class="docutils literal notranslate"><span class="pre">okada_prior()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/earthquakes.html#disstans.earthquakes.empirical_prior"><code class="docutils literal notranslate"><span class="pre">empirical_prior()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../disstans/models.html">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/models.html#model-parent-class">Model (Parent Class)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#disstans.models.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#disstans.models.check_model_dict"><code class="docutils literal notranslate"><span class="pre">check_model_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/models.html#model-collection">Model Collection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#disstans.models.ModelCollection"><code class="docutils literal notranslate"><span class="pre">ModelCollection</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/models.html#fit-collection">Fit Collection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#disstans.models.FitCollection"><code class="docutils literal notranslate"><span class="pre">FitCollection</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/models.html#basic-models">Basic Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#arctangent">Arctangent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#exponential">Exponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#hyperbolic-tangent">Hyperbolic Tangent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#logarithmic">Logarithmic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#polynomial">Polynomial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#step">Step</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#sinusoid">Sinusoid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/models.html#spline-models">Spline Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#bspline">BSpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#ispline">ISpline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#basesplineset">BaseSplineSet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#splineset">SplineSet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#decayingsplineset">DecayingSplineSet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/models.html#ampphmodulatedsinusoid">AmpPhModulatedSinusoid</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../disstans/network.html">Network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network"><code class="docutils literal notranslate"><span class="pre">Network</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.__contains__"><code class="docutils literal notranslate"><span class="pre">Network.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.__delitem__"><code class="docutils literal notranslate"><span class="pre">Network.__delitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.__getitem__"><code class="docutils literal notranslate"><span class="pre">Network.__getitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.__iter__"><code class="docutils literal notranslate"><span class="pre">Network.__iter__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.__len__"><code class="docutils literal notranslate"><span class="pre">Network.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.__setitem__"><code class="docutils literal notranslate"><span class="pre">Network.__setitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.__str__"><code class="docutils literal notranslate"><span class="pre">Network.__str__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.add_default_local_models"><code class="docutils literal notranslate"><span class="pre">Network.add_default_local_models()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.add_local_models"><code class="docutils literal notranslate"><span class="pre">Network.add_local_models()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.add_station"><code class="docutils literal notranslate"><span class="pre">Network.add_station()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.add_unused_local_models"><code class="docutils literal notranslate"><span class="pre">Network.add_unused_local_models()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.ampphaseplot"><code class="docutils literal notranslate"><span class="pre">Network.ampphaseplot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.analyze_residuals"><code class="docutils literal notranslate"><span class="pre">Network.analyze_residuals()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.call_func_no_return"><code class="docutils literal notranslate"><span class="pre">Network.call_func_no_return()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.call_func_ts_return"><code class="docutils literal notranslate"><span class="pre">Network.call_func_ts_return()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.call_netwide_func"><code class="docutils literal notranslate"><span class="pre">Network.call_netwide_func()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.copy_uncertainties"><code class="docutils literal notranslate"><span class="pre">Network.copy_uncertainties()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.create_station"><code class="docutils literal notranslate"><span class="pre">Network.create_station()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.decompose"><code class="docutils literal notranslate"><span class="pre">Network.decompose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.default_local_models"><code class="docutils literal notranslate"><span class="pre">Network.default_local_models</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.default_location_path"><code class="docutils literal notranslate"><span class="pre">Network.default_location_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.euler_rot_field"><code class="docutils literal notranslate"><span class="pre">Network.euler_rot_field()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.evaluate"><code class="docutils literal notranslate"><span class="pre">Network.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.export_network_ts"><code class="docutils literal notranslate"><span class="pre">Network.export_network_ts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.fit"><code class="docutils literal notranslate"><span class="pre">Network.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.fitevalres"><code class="docutils literal notranslate"><span class="pre">Network.fitevalres()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.freeze"><code class="docutils literal notranslate"><span class="pre">Network.freeze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.from_json"><code class="docutils literal notranslate"><span class="pre">Network.from_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.get_stations_with"><code class="docutils literal notranslate"><span class="pre">Network.get_stations_with()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.graphical_cme"><code class="docutils literal notranslate"><span class="pre">Network.graphical_cme()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.gui"><code class="docutils literal notranslate"><span class="pre">Network.gui()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.hom_velocity_field"><code class="docutils literal notranslate"><span class="pre">Network.hom_velocity_field()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.import_network_ts"><code class="docutils literal notranslate"><span class="pre">Network.import_network_ts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.load_maintenance_dict"><code class="docutils literal notranslate"><span class="pre">Network.load_maintenance_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.math"><code class="docutils literal notranslate"><span class="pre">Network.math()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.mean_longitude"><code class="docutils literal notranslate"><span class="pre">Network.mean_longitude</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.name"><code class="docutils literal notranslate"><span class="pre">Network.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.num_stations"><code class="docutils literal notranslate"><span class="pre">Network.num_stations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.plot_availability"><code class="docutils literal notranslate"><span class="pre">Network.plot_availability()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.remove_station"><code class="docutils literal notranslate"><span class="pre">Network.remove_station()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.remove_timeseries"><code class="docutils literal notranslate"><span class="pre">Network.remove_timeseries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.spatialfit"><code class="docutils literal notranslate"><span class="pre">Network.spatialfit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.station_locations"><code class="docutils literal notranslate"><span class="pre">Network.station_locations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.station_names"><code class="docutils literal notranslate"><span class="pre">Network.station_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.stations"><code class="docutils literal notranslate"><span class="pre">Network.stations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.to_json"><code class="docutils literal notranslate"><span class="pre">Network.to_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.unfreeze"><code class="docutils literal notranslate"><span class="pre">Network.unfreeze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.update_default_local_models"><code class="docutils literal notranslate"><span class="pre">Network.update_default_local_models()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/network.html#disstans.network.Network.wormplot"><code class="docutils literal notranslate"><span class="pre">Network.wormplot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../disstans/processing.html">Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/processing.html#unwrap-dict-and-ts">unwrap_dict_and_ts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/processing.html#disstans.processing.unwrap_dict_and_ts"><code class="docutils literal notranslate"><span class="pre">unwrap_dict_and_ts()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/processing.html#functions">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/processing.html#clean">clean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/processing.html#decompose">decompose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/processing.html#median">median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/processing.html#midas">midas</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/processing.html#classes">Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/processing.html#stepdetector">StepDetector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../disstans/solvers.html">Solvers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/solvers.html#solution-object">Solution Object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/solvers.html#disstans.solvers.Solution"><code class="docutils literal notranslate"><span class="pre">Solution</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/solvers.html#solver-functions">Solver Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/solvers.html#lasso-regression">lasso_regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/solvers.html#linear-regression">linear_regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/solvers.html#ridge-regression">ridge_regression</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/solvers.html#reweighting-functions">Reweighting Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/solvers.html#reweightingfunction">ReweightingFunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/solvers.html#inversereweighting">InverseReweighting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/solvers.html#inversesquaredreweighting">InverseSquaredReweighting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/solvers.html#logarithmicreweighting">LogarithmicReweighting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../disstans/station.html">Station</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station"><code class="docutils literal notranslate"><span class="pre">Station</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.__contains__"><code class="docutils literal notranslate"><span class="pre">Station.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.__delitem__"><code class="docutils literal notranslate"><span class="pre">Station.__delitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.__getitem__"><code class="docutils literal notranslate"><span class="pre">Station.__getitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.__iter__"><code class="docutils literal notranslate"><span class="pre">Station.__iter__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.__setitem__"><code class="docutils literal notranslate"><span class="pre">Station.__setitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.__str__"><code class="docutils literal notranslate"><span class="pre">Station.__str__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.add_fit"><code class="docutils literal notranslate"><span class="pre">Station.add_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.add_local_model"><code class="docutils literal notranslate"><span class="pre">Station.add_local_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.add_local_model_dict"><code class="docutils literal notranslate"><span class="pre">Station.add_local_model_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.add_local_model_kwargs"><code class="docutils literal notranslate"><span class="pre">Station.add_local_model_kwargs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.add_timeseries"><code class="docutils literal notranslate"><span class="pre">Station.add_timeseries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.analyze_residuals"><code class="docutils literal notranslate"><span class="pre">Station.analyze_residuals()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.fits"><code class="docutils literal notranslate"><span class="pre">Station.fits</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.get_arch"><code class="docutils literal notranslate"><span class="pre">Station.get_arch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.get_trend"><code class="docutils literal notranslate"><span class="pre">Station.get_trend()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.location"><code class="docutils literal notranslate"><span class="pre">Station.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.models"><code class="docutils literal notranslate"><span class="pre">Station.models</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.name"><code class="docutils literal notranslate"><span class="pre">Station.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.remove_fit"><code class="docutils literal notranslate"><span class="pre">Station.remove_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.remove_local_models"><code class="docutils literal notranslate"><span class="pre">Station.remove_local_models()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.remove_timeseries"><code class="docutils literal notranslate"><span class="pre">Station.remove_timeseries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.sum_fits"><code class="docutils literal notranslate"><span class="pre">Station.sum_fits()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.timeseries"><code class="docutils literal notranslate"><span class="pre">Station.timeseries</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.ts"><code class="docutils literal notranslate"><span class="pre">Station.ts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/station.html#disstans.station.Station.unused_models"><code class="docutils literal notranslate"><span class="pre">Station.unused_models</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../disstans/timeseries.html">Timeseries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/timeseries.html#timeseries-parent-class">Timeseries (Parent Class)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/timeseries.html#disstans.timeseries.Timeseries"><code class="docutils literal notranslate"><span class="pre">Timeseries</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/timeseries.html#specialized-classes">Specialized Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/timeseries.html#gipsytimeseries">GipsyTimeseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/timeseries.html#unrtimeseries">UNRTimeseries</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../disstans/tools.html">Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/tools.html#functions">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#best-utmzone">best_utmzone</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#block-permutation">block_permutation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#cov2corr">cov2corr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#create-powerlaw-noise">create_powerlaw_noise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#date2decyear">date2decyear</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#download-unr-data">download_unr_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#estimate-euler-pole">estimate_euler_pole</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#eulerpole2rotvec">eulerpole2rotvec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#full-cov-mat-to-columns">full_cov_mat_to_columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#get-cov-dims">get_cov_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#make-cov-index-map">make_cov_index_map</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#get-cov-indices">get_cov_indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#get-hom-vel-strain-rot">get_hom_vel_strain_rot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#parallelize">parallelize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#parse-maintenance-table">parse_maintenance_table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#parse-unr-steps">parse_unr_steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#r-ecef2enu">R_ecef2enu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#r-enu2ecef">R_enu2ecef</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#rotvec2eulerpole">rotvec2eulerpole</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#strain-rotation-invariants">strain_rotation_invariants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#tvec-to-numpycol">tvec_to_numpycol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#weighted-median">weighted_median</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../disstans/tools.html#classes">Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#click">Click</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#rinexdataholding">RINEXDataHolding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../disstans/tools.html#timedelta">Timedelta</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DISSTANS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">disstans.station</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for disstans.station</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains the :class:`~Station` class, which is the main</span>
<span class="sd">component of a :class:`~disstans.network.Network` and contains</span>
<span class="sd">:class:`~disstans.timeseries.Timeseries`, :class:`~disstans.models.Model` and</span>
<span class="sd">associated fits.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="k">as</span> <span class="nn">sparse</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Iterator</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">models</span> <span class="k">as</span> <span class="n">disstans_models</span>
<span class="kn">from</span> <span class="nn">.timeseries</span> <span class="kn">import</span> <span class="n">Timeseries</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">ModelCollection</span><span class="p">,</span> <span class="n">FitCollection</span>
<span class="kn">from</span> <span class="nn">.tools</span> <span class="kn">import</span> <span class="n">tvec_to_numpycol</span>


<div class="viewcode-block" id="Station"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station">[docs]</a><span class="k">class</span> <span class="nc">Station</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Representation of a station, which contains both metadata</span>
<span class="sd">    such as location as well as timeseries, models and fits.</span>

<span class="sd">    Timeseries are saved in the :attr:`~timeseries` dictionary, and their associated</span>
<span class="sd">    models and fits are saved in the :attr:`~models` and :attr:`~fits`</span>
<span class="sd">    dictionaries, respectively.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name</span>
<span class="sd">        Name of the station.</span>
<span class="sd">    location</span>
<span class="sd">        Location (Latitude [°], Longitude [°], Altitude [m]) of the station.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">location</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Name of the station. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">location</span><span class="p">])</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">location</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Location of the station (Latitude [°], Longitude [°], Altitude [m]). &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span> <span class="o">=</span> <span class="p">{}</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary of timeseries, where the keys are their string descriptions</span>
<span class="sd">        and the values are :class:`~disstans.timeseries.Timeseries` instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary of :class:`~disstans.models.ModelCollection` objects associated</span>
<span class="sd">        with a timeseries saved in :attr:`~timeseries`.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If ``&#39;myts&#39;`` is a timeseries saved in the station ``stat``,</span>
<span class="sd">        then the model collection object for that timeseries is stored in::</span>

<span class="sd">            stat.models[&#39;myts&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unused_models</span> <span class="o">=</span> <span class="p">{}</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Same as :attr:`~models` but for models whose timeseries is not present</span>
<span class="sd">        in :attr:`~timeseries`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fits</span> <span class="o">=</span> <span class="p">{}</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary of :class:`~disstans.models.FitCollection` objects</span>
<span class="sd">        associated with a timeseries saved in :attr:`~timeseries`.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If ``&#39;myts&#39;`` is a timeseries saved in the station ``stat``,</span>
<span class="sd">        and ``&#39;mymodel&#39;`` is the name of a model that is associated with it,</span>
<span class="sd">        then the fitted timeseries is saved as::</span>

<span class="sd">            stat.fits[&#39;myts&#39;][&#39;mymodel&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Station.__str__"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.__str__">[docs]</a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Special function that returns a readable summary of the station.</span>
<span class="sd">        Accessed, for example, by Python&#39;s ``print()`` built-in function.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Station summary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="si">}</span><span class="s2"> with timeseries&quot;</span>
        <span class="k">for</span> <span class="n">ts_description</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">info</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Timeseries&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Models: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">model_names</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Fits: </span><span class="si">{</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">info</span></div>

<div class="viewcode-block" id="Station.__getitem__"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timeseries</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience special function that provides a shorthand notation</span>
<span class="sd">        to access the station&#39;s timeseries.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Description of the timeseries.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Timeseries in station.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If ``stat`` is a :class:`~Station` instance and ``ts_description`` the</span>
<span class="sd">        ts_description of a station, the following two are equivalent::</span>

<span class="sd">            stat.timeseries[ts_description]</span>
<span class="sd">            stat[ts_description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ts_description</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: No timeseries &#39;</span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&#39; present.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span></div>

<div class="viewcode-block" id="Station.__setitem__"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.__setitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">:</span> <span class="n">Timeseries</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience special function that allows a dictionary-like adding of timeseries to</span>
<span class="sd">        the station by wrapping :meth:`~add_timeseries`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        add_timeseries : Add a timeseries to the station instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_timeseries</span><span class="p">(</span><span class="n">ts_description</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">,</span> <span class="n">warn_existing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Station.__delitem__"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.__delitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience special function that allows a dictionary-like removing of timeseries from</span>
<span class="sd">        the station by wrapping :meth:`~remove_timeseries`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        remove_timeseries : Remove a timeseries from the station instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_timeseries</span><span class="p">(</span><span class="n">ts_description</span><span class="p">)</span></div>

<div class="viewcode-block" id="Station.__contains__"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.__contains__">[docs]</a>    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Special function that allows to check whether a certain timeseries</span>
<span class="sd">        is in the station.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If ``mystat`` is a :class:`~Station` instance, and we want to see whether</span>
<span class="sd">        ``&#39;myts&#39;`` is contained by the station, the following two are equivalent::</span>

<span class="sd">            # long version</span>
<span class="sd">            &#39;myts&#39; in station.timeseries</span>
<span class="sd">            # short version</span>
<span class="sd">            &#39;myts&#39; in station</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ts_description</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span></div>

<div class="viewcode-block" id="Station.__iter__"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.__iter__">[docs]</a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Timeseries</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience special function that allows for a shorthand notation to quickly</span>
<span class="sd">        iterate over all timeseries.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If ``stat`` is a :class:`~Station` instance,then the following two loops</span>
<span class="sd">        are equivalent::</span>

<span class="sd">            # long version</span>
<span class="sd">            for ts in stat.timeseries.values():</span>
<span class="sd">                pass</span>
<span class="sd">            # shorthand</span>
<span class="sd">            for ts in stat:</span>
<span class="sd">                pass</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">yield</span> <span class="n">ts</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Timeseries</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Abbreviation for :attr:`~timeseries`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span>

<div class="viewcode-block" id="Station.get_arch"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.get_arch">[docs]</a>    <span class="k">def</span> <span class="nf">get_arch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build a dictionary describing the architecture of this station,</span>
<span class="sd">        to be used when creating a network JSON configuration file.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Ditionary of attributes.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        disstans.network.Network.to_json</span>
<span class="sd">            Export the Network configuration as a JSON file.</span>
<span class="sd">        disstans.timeseries.Timeseries.get_arch</span>
<span class="sd">            Get the architecture dictionary of a</span>
<span class="sd">            :class:`~disstans.timeseries.Timeseries` instance.</span>
<span class="sd">        disstans.models.Model.get_arch</span>
<span class="sd">            Get the architecture dictionary of a</span>
<span class="sd">            :class:`~disstans.models.Model` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create empty dictionary</span>
        <span class="n">stat_arch</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span>
                     <span class="s2">&quot;timeseries&quot;</span><span class="p">:</span> <span class="p">{},</span>
                     <span class="s2">&quot;models&quot;</span><span class="p">:</span> <span class="p">{}}</span>
        <span class="c1"># add each timeseries and model</span>
        <span class="k">for</span> <span class="n">ts_description</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ts_arch</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">get_arch</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ts_arch</span> <span class="o">!=</span> <span class="p">{}:</span>
                <span class="n">stat_arch</span><span class="p">[</span><span class="s2">&quot;timeseries&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">ts_description</span><span class="p">:</span> <span class="n">ts_arch</span><span class="p">})</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">stat_arch</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">][</span><span class="n">ts_description</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">get_arch</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">stat_arch</span></div>

<div class="viewcode-block" id="Station.add_timeseries"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.add_timeseries">[docs]</a>    <span class="k">def</span> <span class="nf">add_timeseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">timeseries</span><span class="p">:</span> <span class="n">Timeseries</span><span class="p">,</span>
                       <span class="n">uncertainties_from</span><span class="p">:</span> <span class="n">Timeseries</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">override_src</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">override_data_unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">override_data_cols</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">override_var_cols</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">override_cov_cols</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">add_models</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Model</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">warn_existing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
                       <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a timeseries to the station.</span>

<span class="sd">        Optionally, can override some Timeseries attributes when adding the object,</span>
<span class="sd">        and add models.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Description of the timeseries.</span>
<span class="sd">        timeseries</span>
<span class="sd">            Timeseries object to add.</span>
<span class="sd">        uncertainties_from</span>
<span class="sd">            If the variance and covariance data should come from another timeseries,</span>
<span class="sd">            specify the source timeseries here.</span>
<span class="sd">        override_src</span>
<span class="sd">            Override the :attr:`~disstans.timeseries.Timeseries.src`</span>
<span class="sd">            attribute of ``timeseries``.</span>
<span class="sd">        override_data_unit</span>
<span class="sd">            Override the :attr:`~disstans.timeseries.Timeseries.data_unit`</span>
<span class="sd">            attribute of ``timeseries``.</span>
<span class="sd">        override_data_cols</span>
<span class="sd">            Override the :attr:`~disstans.timeseries.Timeseries.data_cols`</span>
<span class="sd">            attribute of ``timeseries``.</span>
<span class="sd">        override_var_cols</span>
<span class="sd">            Override the :attr:`~disstans.timeseries.Timeseries.var_cols`</span>
<span class="sd">            attribute of ``timeseries``.</span>
<span class="sd">        override_cov_cols</span>
<span class="sd">            Override the :attr:`~disstans.timeseries.Timeseries.cov_cols`</span>
<span class="sd">            attribute of ``timeseries``.</span>
<span class="sd">        add_models</span>
<span class="sd">            Dictionary of models to add to the timeseries, where the keys are the</span>
<span class="sd">            model description and the values are :class:`~disstans.models.Model` objects.</span>
<span class="sd">        warn_existing</span>
<span class="sd">            Issue a warning if a station&#39;s timeseries is being overwritten.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        __setitem__ : Shorthand notation wrapper when no optional arguments are necessary.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If ``stat`` is a :class:`~Station` instance, ``ts_description`` the ts_description</span>
<span class="sd">        of a new timeseries, and ``ts`` a :class:`~disstans.timeseries.Timeseries` instance,</span>
<span class="sd">        then the following two are equivalent::</span>

<span class="sd">            stat.add_timeseries(ts_description, timeseries)</span>
<span class="sd">            stat[ts_description] = timeseries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts_description</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot add new timeseries: &quot;</span>
                            <span class="s2">&quot;&#39;ts_description&#39; is not a string.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">Timeseries</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot add new timeseries: &quot;</span>
                            <span class="s2">&quot;&#39;timeseries&#39; is not a Timeseries object.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">warn_existing</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ts_description</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">):</span>
            <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Overwriting time series &#39;</span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
                 <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">uncertainties_from</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timeseries</span><span class="o">.</span><span class="n">add_uncertainties</span><span class="p">(</span><span class="n">timeseries</span><span class="o">=</span><span class="n">uncertainties_from</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">override_src</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timeseries</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">override_src</span>
        <span class="k">if</span> <span class="n">override_data_unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timeseries</span><span class="o">.</span><span class="n">data_unit</span> <span class="o">=</span> <span class="n">override_data_unit</span>
        <span class="k">if</span> <span class="n">override_data_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timeseries</span><span class="o">.</span><span class="n">data_cols</span> <span class="o">=</span> <span class="n">override_data_cols</span>
        <span class="k">if</span> <span class="n">override_var_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timeseries</span><span class="o">.</span><span class="n">var_cols</span> <span class="o">=</span> <span class="n">override_var_cols</span>
        <span class="k">if</span> <span class="n">override_cov_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timeseries</span><span class="o">.</span><span class="n">var_cols</span> <span class="o">=</span> <span class="n">override_cov_cols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span> <span class="o">=</span> <span class="n">timeseries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span> <span class="o">=</span> <span class="n">FitCollection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span> <span class="o">=</span> <span class="n">ModelCollection</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">add_models</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_local_model_dict</span><span class="p">(</span><span class="n">ts_description</span><span class="o">=</span><span class="n">ts_description</span><span class="p">,</span> <span class="n">model_kw_args</span><span class="o">=</span><span class="n">add_models</span><span class="p">)</span></div>

<div class="viewcode-block" id="Station.remove_timeseries"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.remove_timeseries">[docs]</a>    <span class="k">def</span> <span class="nf">remove_timeseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove a timeseries (including associated fits and models) from the station.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Description of the timeseries.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        __delitem__ : Shorthand notation wrapper.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If ``stat`` is a :class:`~Station` instance, ``ts_description`` the ts_description</span>
<span class="sd">        of the timeseries to remove, then the following two are equivalent::</span>

<span class="sd">            stat.remove_timeseries(ts_description)</span>
<span class="sd">            del stat[ts_description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ts_description</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Cannot find time series &#39;</span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&#39;, couldn&#39;t delete.&quot;</span><span class="p">,</span>
                 <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span></div>

<div class="viewcode-block" id="Station.add_local_model"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.add_local_model">[docs]</a>    <span class="k">def</span> <span class="nf">add_local_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                        <span class="n">model_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                        <span class="n">model</span><span class="p">:</span> <span class="n">Model</span>
                        <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a model to a timeseries (overwrites the model if it has already</span>
<span class="sd">        been added with the same description).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Timeseries to add the model to.</span>
<span class="sd">        model_description</span>
<span class="sd">            Model description.</span>
<span class="sd">        model</span>
<span class="sd">            Model object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts_description</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot add new local model: &#39;ts_description&#39; is not a string.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_description</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot add new local model: &#39;model_description&#39; is not a string.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Model</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot add new local model: &#39;model&#39; is not a Model object.&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">ts_description</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">,</span> \
            <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &quot;</span> \
            <span class="sa">f</span><span class="s2">&quot;Cannot find timeseries &#39;</span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&#39; to add local model &#39;</span><span class="si">{</span><span class="n">model_description</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="k">if</span> <span class="n">model_description</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">model_names</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, timeseries </span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">: &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Overwriting local model &#39;</span><span class="si">{</span><span class="n">model_description</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
                 <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">][</span><span class="n">model_description</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span></div>

<div class="viewcode-block" id="Station.add_local_model_dict"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.add_local_model_dict">[docs]</a>    <span class="k">def</span> <span class="nf">add_local_model_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Model</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a dictionary of models to a timeseries (overwrites the models if they have already</span>
<span class="sd">        been added with the same description).</span>

<span class="sd">        Wraps :meth:`~add_local_model`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Timeseries to add the model to.</span>
<span class="sd">        model_dict</span>
<span class="sd">            Dictionary of ``{model_description: model}`` key-value pairs to add.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> \
            <span class="sa">f</span><span class="s2">&quot;&#39;model_dict&#39; needs to be a dictionary, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">model_dict</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">for</span> <span class="n">mdl_desc</span><span class="p">,</span> <span class="n">mdl</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_local_model</span><span class="p">(</span><span class="n">ts_description</span><span class="p">,</span> <span class="n">mdl_desc</span><span class="p">,</span> <span class="n">mdl</span><span class="p">)</span></div>

<div class="viewcode-block" id="Station.add_local_model_kwargs"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.add_local_model_kwargs">[docs]</a>    <span class="k">def</span> <span class="nf">add_local_model_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                               <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                               <span class="n">model_kw_args</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
                               <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add models to a timeseries from a dictionary of keyword arguments needed to create</span>
<span class="sd">        them (overwrites the models if they have already been added with the same description).</span>

<span class="sd">        Wraps :meth:`~add_local_model`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Timeseries to add the model to.</span>
<span class="sd">        model_kw_args</span>
<span class="sd">            Dictionary of structure ``{model_name: {&quot;type&quot;: modelclass, &quot;kw_args&quot;:</span>
<span class="sd">            {**kw_args}}}`` that contains the names, types and necessary keyword arguments</span>
<span class="sd">            to create each model object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">disstans_models</span><span class="o">.</span><span class="n">check_model_dict</span><span class="p">(</span><span class="n">model_kw_args</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mdl_desc</span><span class="p">,</span> <span class="n">mdl_cfg</span> <span class="ow">in</span> <span class="n">model_kw_args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">local_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">mdl_cfg</span><span class="p">)</span>
            <span class="n">mdl</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">disstans_models</span><span class="p">,</span> <span class="n">local_copy</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])(</span><span class="o">**</span><span class="n">local_copy</span><span class="p">[</span><span class="s2">&quot;kw_args&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_local_model</span><span class="p">(</span><span class="n">ts_description</span><span class="o">=</span><span class="n">ts_description</span><span class="p">,</span>
                                 <span class="n">model_description</span><span class="o">=</span><span class="n">mdl_desc</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">mdl</span><span class="p">)</span></div>

<div class="viewcode-block" id="Station.remove_local_models"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.remove_local_models">[docs]</a>    <span class="k">def</span> <span class="nf">remove_local_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                            <span class="n">model_descriptions</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                            <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove models from a timeseries.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Timeseries to remove the model from.</span>
<span class="sd">        model_descriptions</span>
<span class="sd">            Model description(s).</span>
<span class="sd">        verbose</span>
<span class="sd">            If ``True``, raise a warning if a timeseries or model could not be found</span>
<span class="sd">            in the network.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># unpack list</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_descriptions</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">model_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_descriptions</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model_list</span> <span class="o">=</span> <span class="n">model_descriptions</span>
        <span class="c1"># iterate removal</span>
        <span class="k">for</span> <span class="n">mdl_desc</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ts_description</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mdl_desc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">model_names</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">][</span><span class="n">mdl_desc</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">mdl_desc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]:</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">][</span><span class="n">mdl_desc</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, timeseries </span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">: &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;Cannot find local model &#39;</span><span class="si">{</span><span class="n">mdl_desc</span><span class="si">}</span><span class="s2">&#39;, couldn&#39;t delete.&quot;</span><span class="p">,</span>
                         <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Cannot find timeseries &#39;</span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;couldn&#39;t delete local model &#39;</span><span class="si">{</span><span class="n">mdl_desc</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
                     <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="Station.add_fit"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.add_fit">[docs]</a>    <span class="k">def</span> <span class="nf">add_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                <span class="n">fit</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
                <span class="n">model_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">return_ts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timeseries</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a fit dictionary to a timeseries&#39; model (overwrites the fit if it has</span>
<span class="sd">        already been added for the model).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Timeseries to add the fit to.</span>
<span class="sd">        fit</span>
<span class="sd">            Dictionary with the keys ``&#39;time&#39;``, ``&#39;fit&#39;``, ``&#39;var&#39;`` and ``&#39;cov&#39;``</span>
<span class="sd">            (the latter two can be set to ``None``).</span>
<span class="sd">        model_description</span>
<span class="sd">            Model description the fit applies to.</span>
<span class="sd">            If ``None``, the fit is the sum of all individual model fits.</span>
<span class="sd">        return_ts</span>
<span class="sd">            If ``True``, return the created timeseries.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            (If ``return_ts=True``.) The fit as a Timeseries object.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        disstans.timeseries.Timeseries.from_fit</span>
<span class="sd">            Convert a fit dictionary to a :class:`~disstans.timeseries.Timeseries` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts_description</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot add new fit: &#39;ts_description&#39; is not a string.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">model_description</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">model_description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot add new fit: &#39;model_description&#39; is not a string.&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">ts_description</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">,</span> \
            <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Cannot find timeseries &#39;</span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&#39; &quot;</span> \
            <span class="sa">f</span><span class="s2">&quot;to add fit for model &#39;</span><span class="si">{</span><span class="n">model_description</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="k">if</span> <span class="n">model_description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">ts_description</span> <span class="o">+</span> <span class="s2">&quot;_Model_&quot;</span> <span class="o">+</span> <span class="n">dcol</span>
                         <span class="k">for</span> <span class="n">dcol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">data_cols</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">ts_description</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">model_description</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">dcol</span>
                         <span class="k">for</span> <span class="n">dcol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">data_cols</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">model_description</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">],</span> \
                <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, timeseries </span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">: &quot;</span> \
                <span class="sa">f</span><span class="s2">&quot;Cannot find local model &#39;</span><span class="si">{</span><span class="n">model_description</span><span class="si">}</span><span class="s2">&#39;, couldn&#39;t add fit.&quot;</span>
        <span class="n">fit_ts</span> <span class="o">=</span> <span class="n">Timeseries</span><span class="o">.</span><span class="n">from_fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">data_unit</span><span class="p">,</span> <span class="n">data_cols</span><span class="p">,</span> <span class="n">fit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">model_description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">allfits</span> <span class="o">=</span> <span class="n">fit_ts</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">][</span><span class="n">model_description</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_ts</span>
        <span class="k">if</span> <span class="n">return_ts</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fit_ts</span></div>

<div class="viewcode-block" id="Station.remove_fit"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.remove_fit">[docs]</a>    <span class="k">def</span> <span class="nf">remove_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove a fit from a timeseries&#39; model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Timeseries to remove the fit from.</span>
<span class="sd">        model_description</span>
<span class="sd">            Model description to remove the fit from.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ts_description</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Cannot find timeseries &#39;</span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;couldn&#39;t delete fit for model &#39;</span><span class="si">{</span><span class="n">model_description</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
                 <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_description</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]:</span>
            <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, timeseries </span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">: &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Cannot find local model &#39;</span><span class="si">{</span><span class="n">model_description</span><span class="si">}</span><span class="s2">&#39;, couldn&#39;t delete fit.&quot;</span><span class="p">,</span>
                 <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_description</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]:</span>
            <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, timeseries </span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">: &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;Cannot find fit for local model &#39;</span><span class="si">{</span><span class="n">model_description</span><span class="si">}</span><span class="s2">&#39;, couldn&#39;t delete.&quot;</span><span class="p">,</span>
                 <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">][</span><span class="n">model_description</span><span class="p">]</span></div>

<div class="viewcode-block" id="Station.sum_fits"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.sum_fits">[docs]</a>    <span class="k">def</span> <span class="nf">sum_fits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">fit_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to quickly sum fits of a timeseries.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Timeseries whose fits to sum.</span>
<span class="sd">        fit_list</span>
<span class="sd">            List of strings containing the model names of the subset of the fitted models</span>
<span class="sd">            to be summed. ``None`` defaults to all fitted models.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fit_sum</span>
<span class="sd">            2D array of shape :math:`(\text{n_observations},\text{n_components})`</span>
<span class="sd">        fit_sum_var</span>
<span class="sd">            2D array of shape :math:`(\text{n_observations},\text{n_components})`.</span>
<span class="sd">            Returns ``None`` if no standard deviations are available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># shorthand for timeseries</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">fit_list</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> \
            <span class="sa">f</span><span class="s2">&quot;&#39;fit_list&#39; needs to be None or a list, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">fit_list</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="c1"># get model subset</span>
        <span class="n">fits_to_sum</span> <span class="o">=</span> <span class="p">{</span><span class="n">model_description</span><span class="p">:</span> <span class="n">fit</span>
                       <span class="k">for</span> <span class="n">model_description</span><span class="p">,</span> <span class="n">fit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                       <span class="k">if</span> <span class="p">((</span><span class="n">fit_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">model_description</span> <span class="ow">in</span> <span class="n">fit_list</span><span class="p">))}</span>
        <span class="k">assert</span> <span class="n">fits_to_sum</span><span class="p">,</span> \
            <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, timeseries </span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">: Can&#39;t find fits for models.&quot;</span>
        <span class="c1"># sum models and uncertainties</span>
        <span class="n">fit_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ts</span><span class="o">.</span><span class="n">num_observations</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">num_components</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">var_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">fit</span><span class="o">.</span><span class="n">var_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                                              <span class="k">for</span> <span class="n">fit</span> <span class="ow">in</span> <span class="n">fits_to_sum</span><span class="o">.</span><span class="n">values</span><span class="p">()]):</span>
            <span class="n">fit_sum_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">fit_sum</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fit_sum_var</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">model_description</span><span class="p">,</span> <span class="n">fit</span> <span class="ow">in</span> <span class="n">fits_to_sum</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">fit_sum</span> <span class="o">+=</span> <span class="n">fit</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">values</span>
            <span class="k">if</span> <span class="n">fit_sum_var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fit_sum_var</span> <span class="o">+=</span> <span class="n">fit</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">values</span>
        <span class="k">return</span> <span class="n">fit_sum</span><span class="p">,</span> <span class="n">fit_sum_var</span></div>

<div class="viewcode-block" id="Station.analyze_residuals"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.analyze_residuals">[docs]</a>    <span class="k">def</span> <span class="nf">analyze_residuals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="n">t_start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">t_end</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">mean</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="n">std</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="n">rms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="n">n_observations</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="n">std_outlier</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                          <span class="n">max_rolling_dev</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
                          <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analyze, print and return the residuals of a station&#39;s timeseries according</span>
<span class="sd">        to certain metrics defined in the arguments.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Timeseries to analyze. Method assumes it already is a residual.</span>
<span class="sd">        verbose</span>
<span class="sd">            If True, additionally print the results.</span>
<span class="sd">        t_start</span>
<span class="sd">            If set, specify a lower bound for the analysis. ``t_start`` should be a</span>
<span class="sd">            Timestamp-convertible string of the start time, or a datetime-like object.</span>
<span class="sd">            ``None`` defaults to the first timestamp present in the timeseries.</span>
<span class="sd">        t_end</span>
<span class="sd">            If set, specify an upper bound for the analysis. ``t_end`` should be a</span>
<span class="sd">            Timestamp-convertible string of the end time, or a datetime-like object.</span>
<span class="sd">            ``None`` defaults to the last timestamp present in the timeseries.</span>
<span class="sd">        mean</span>
<span class="sd">            If ``True``, calculate the mean of the timeseries.</span>
<span class="sd">            Adds the key ``&#39;Mean&#39;`` to the output dictionary.</span>
<span class="sd">        std</span>
<span class="sd">            If ``True``, calculate the standard deviation of the timeseries.</span>
<span class="sd">            Adds the key ``&#39;Standard Deviation&#39;`` to the output dictionary.</span>
<span class="sd">        rms</span>
<span class="sd">            If ``True``, calculate the root-mean-squared over all components combined,</span>
<span class="sd">            or if ``rms`` is a list, only using those components.</span>
<span class="sd">            Adds the key ``&#39;RMS&#39;`` to the output dictionary.</span>
<span class="sd">        n_observations</span>
<span class="sd">            If ``True``, count the number of observations (excluding NaNs) and NaNs.</span>
<span class="sd">            Adds the keys ``&#39;Observations&#39;`` and ``&#39;Gaps&#39;`` to the output dictionary.</span>
<span class="sd">        std_outlier</span>
<span class="sd">            If ``std_outlier &gt; 0``, count the number of non-NaN outliers, defined</span>
<span class="sd">            by the number of standard deviations they are away from the mean.</span>
<span class="sd">            Adds the key ``&#39;Outliers&#39;`` to the output dictionary.</span>
<span class="sd">        max_rolling_dev</span>
<span class="sd">            If ``max_rolling_dev &gt; 0``, calculate the (sign-aware) maximum of the</span>
<span class="sd">            rolling deviation from the mean with window size ``max_rolling_dev`` for</span>
<span class="sd">            each component. If this is significantly larger than the standard deviation,</span>
<span class="sd">            this is an indicator of model inadequacies, as not all the data trends can</span>
<span class="sd">            be captured.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Dictionary that includes the results as defined by the arguments.</span>
<span class="sd">            Empty by default.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># do checks</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts_description</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> \
            <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &quot;</span> \
            <span class="sa">f</span><span class="s2">&quot;&#39;ts_description&#39; needs to be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ts_description</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">assert</span> <span class="n">ts_description</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">,</span> \
            <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Can&#39;t find &#39;</span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&#39; to analyze.&quot;</span>
        <span class="c1"># restrict to time range</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span>
        <span class="n">t_start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t_start</span><span class="p">)</span> <span class="k">if</span> <span class="n">t_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">t_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t_end</span><span class="p">)</span> <span class="k">if</span> <span class="n">t_end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">t_end</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">inside</span><span class="p">,</span> <span class="p">:]</span>
        <span class="c1"># calculate the different metrics</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">mean</span><span class="p">:</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean</span>
        <span class="k">if</span> <span class="n">std</span><span class="p">:</span>
            <span class="n">std</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Standard Deviation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">std</span>
        <span class="k">if</span> <span class="n">rms</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rms</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">rms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">num_components</span><span class="p">))</span>
            <span class="n">rms_result</span> <span class="o">=</span> <span class="p">((</span><span class="n">ts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">rms</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                          <span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_observations</span><span class="p">:</span>
            <span class="n">n_obs</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Observations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_obs</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Gaps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">n_obs</span>
        <span class="k">if</span> <span class="n">std_outlier</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">temp</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">temp</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="n">std_outlier</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Outliers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_rolling_dev</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">roll_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">ts</span> <span class="o">-</span> <span class="n">ts</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">max_rolling_dev</span><span class="p">,</span>
                                                 <span class="n">min_periods</span><span class="o">=</span><span class="n">max_rolling_dev</span><span class="o">//</span><span class="mi">2</span>
                                                 <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">roll_mean</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Maximum Rolling Deviation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">roll_mean_max_ix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanargmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">roll_mean</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">max_rolling_dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">roll_mean</span><span class="p">,</span>
                                                     <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">roll_mean_max_ix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                                                     <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Maximum Rolling Deviation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_rolling_dev</span>
        <span class="c1"># print if any statistic was recorded</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">print_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">data_cols</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">print_df</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">rms</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMS of components </span><span class="si">{</span><span class="n">rms</span><span class="si">}</span><span class="s2">: &quot;</span>
                      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rms_result</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span><span class="o">.</span><span class="n">data_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># attach RMS here since it couldn&#39;t be added to the DataFrame before</span>
        <span class="k">if</span> <span class="n">rms</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;RMS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rms_result</span>
        <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="Station.get_trend"><a class="viewcode-back" href="../../disstans/station.html#disstans.station.Station.get_trend">[docs]</a>    <span class="k">def</span> <span class="nf">get_trend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">ts_description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                  <span class="n">fit_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">components</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">total</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">t_start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">t_end</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">use_formal_variance</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">include_sigma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">time_unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
                  <span class="n">ignore_missing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates a linear trend through the desired model fits (or timeseries data)</span>
<span class="sd">        and over some time span.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ts_description</span>
<span class="sd">            Timeseries whose fits to use.</span>
<span class="sd">        fit_list</span>
<span class="sd">            List of strings containing the model names of the subset of the fitted models</span>
<span class="sd">            to be used. ``None`` defaults to all fitted models.</span>
<span class="sd">            If ``ts_description`` the trend of the timeseries itself is to be calculated,</span>
<span class="sd">            pass an empty list (``[]``).</span>
<span class="sd">        components</span>
<span class="sd">            List of the numerical indices of which components of the timeseries to use.</span>
<span class="sd">            ``None`` defaults to all components.</span>
<span class="sd">        total</span>
<span class="sd">            By default, the function will return the trend per ``time_unit``.</span>
<span class="sd">            If ``True``, the function will instead give the total difference over the</span>
<span class="sd">            entire timespan.</span>
<span class="sd">        t_start</span>
<span class="sd">            Timestamp-convertible string of the start time.</span>
<span class="sd">            ``None`` defaults to the first timestamp present in the timeseries.</span>
<span class="sd">        t_end</span>
<span class="sd">            Timestamp-convertible string of the end time.</span>
<span class="sd">            ``None`` defaults to the last timestamp present in the timeseries.</span>
<span class="sd">        use_formal_variance</span>
<span class="sd">            By default, the trend fitting will use variance information if present. This usually</span>
<span class="sd">            makes sense for actual timeseries, but not for fitted models where the formal variance</span>
<span class="sd">            can be very unphysical. Setting this parameter overrides the default behavior.</span>
<span class="sd">        include_sigma</span>
<span class="sd">            If ``True``, also calculate the formal standard deviation on the trend estimate.</span>
<span class="sd">        time_unit</span>
<span class="sd">            Time unit for output (only required if ``total=False``).</span>
<span class="sd">        ignore_missing</span>
<span class="sd">            By default, this method will throw an error if the timeseries or</span>
<span class="sd">            the models are not present in  the station. Set to ``True`` if the method</span>
<span class="sd">            should return ``(None, None)`` instead (as done when the requested timespan</span>
<span class="sd">            is outside the observed one).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        trend</span>
<span class="sd">            1D array of size ``len(components)`` containing the trends.</span>
<span class="sd">        trend_sigma</span>
<span class="sd">            1D array of size ``len(components)`` containing the standard deviation of</span>
<span class="sd">            the trend estimate. Returns ``None`` if no standard deviations are available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts_description</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> \
            <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &quot;</span> \
            <span class="sa">f</span><span class="s2">&quot;&#39;ts_description&#39; needs to be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ts_description</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">ts_description</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">,</span> \
                <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Can&#39;t find &#39;</span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">&#39; to calculate a trend for.&quot;</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ignore_missing</span><span class="p">:</span>  <span class="c1"># fail softly</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>
        <span class="k">if</span> <span class="n">fit_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">fit_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">fit_list</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s2">&quot;&#39;fit_list&#39; needs to be None, a string, &quot;</span> \
                    <span class="sa">f</span><span class="s2">&quot;or a list, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">fit_list</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># use data instead of fits</span>
                <span class="n">use_fits</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># use a model subset list</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span> <span class="ow">and</span>
                            <span class="nb">any</span><span class="p">([</span><span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fit_list</span><span class="p">])),</span> \
                        <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, timeseries </span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">: &quot;</span> \
                        <span class="s2">&quot;Can&#39;t find any models.&quot;</span>
                <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ignore_missing</span><span class="p">:</span>  <span class="c1"># fail softly</span>
                        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">use_fits</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># default to all fitted models</span>
            <span class="n">use_fits</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># check components</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">ts_description</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">components</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">components</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">num_components</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">max</span><span class="p">(</span><span class="n">components</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ts</span><span class="o">.</span><span class="n">num_components</span><span class="p">,</span> \
                <span class="sa">f</span><span class="s2">&quot;Station </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, timeseries </span><span class="si">{</span><span class="n">ts_description</span><span class="si">}</span><span class="s2">: &quot;</span> \
                <span class="s2">&quot;Requesting non-existent components.&quot;</span>
        <span class="n">n_comps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="c1"># get time span</span>
        <span class="n">t_start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t_start</span><span class="p">)</span> <span class="k">if</span> <span class="n">t_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">t_end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t_end</span><span class="p">)</span> <span class="k">if</span> <span class="n">t_end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;=</span> <span class="n">t_end</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inside</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">t_span</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">inside</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="c1"># get relevant timeseries</span>
        <span class="k">if</span> <span class="n">use_fits</span><span class="p">:</span>
            <span class="n">fit_sum</span><span class="p">,</span> <span class="n">fit_sum_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_fits</span><span class="p">(</span><span class="n">ts_description</span><span class="p">,</span> <span class="n">fit_list</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">use_formal_variance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">use_formal_variance</span><span class="p">):</span>
                <span class="n">fit_sum_var</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fit_sum</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">values</span>
            <span class="k">if</span> <span class="n">use_formal_variance</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">use_formal_variance</span><span class="p">:</span>
                <span class="n">fit_sum_var</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">ts</span><span class="o">.</span><span class="n">var_cols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ts</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fit_sum_var</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># initialize fitting</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">t_span</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">G</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">tvec_to_numpycol</span><span class="p">(</span><span class="n">t_span</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="n">time_unit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">total</span><span class="p">:</span>
            <span class="n">G</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">G</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_comps</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">include_sigma</span><span class="p">:</span>
            <span class="n">trend_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_comps</span><span class="p">)</span>
        <span class="c1"># fit components</span>
        <span class="k">for</span> <span class="n">icomp</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">use_fits</span><span class="p">:</span>
                <span class="n">validsub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">inside</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
                <span class="n">Gsub</span> <span class="o">=</span> <span class="n">G</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fit_sum_var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">validsub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">fit_sum</span><span class="p">[</span><span class="n">inside</span><span class="p">,</span> <span class="n">icomp</span><span class="p">]),</span>
                                       <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">fit_sum_var</span><span class="p">[</span><span class="n">inside</span><span class="p">,</span> <span class="n">icomp</span><span class="p">])),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">validsub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">fit_sum</span><span class="p">[</span><span class="n">inside</span><span class="p">,</span> <span class="n">icomp</span><span class="p">])</span>
                <span class="n">Gsub</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">validsub</span><span class="p">,</span> <span class="p">:]</span>
                <span class="k">if</span> <span class="n">Gsub</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">fit_sum_var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">GtW</span> <span class="o">=</span> <span class="n">Gsub</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">fit_sum_var</span><span class="p">[</span><span class="n">inside</span><span class="p">,</span> <span class="n">icomp</span><span class="p">][</span><span class="n">validsub</span><span class="p">])</span>
                <span class="n">GtWG</span> <span class="o">=</span> <span class="n">GtW</span> <span class="o">@</span> <span class="n">Gsub</span>
                <span class="n">GtWd</span> <span class="o">=</span> <span class="n">GtW</span> <span class="o">@</span> <span class="n">fit_sum</span><span class="p">[</span><span class="n">inside</span><span class="p">,</span> <span class="n">icomp</span><span class="p">][</span><span class="n">validsub</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">GtWG</span> <span class="o">=</span> <span class="n">Gsub</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">Gsub</span>
                <span class="n">GtWd</span> <span class="o">=</span> <span class="n">Gsub</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">fit_sum</span><span class="p">[</span><span class="n">inside</span><span class="p">,</span> <span class="n">icomp</span><span class="p">][</span><span class="n">validsub</span><span class="p">]</span>
            <span class="n">trend</span><span class="p">[</span><span class="n">icomp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">GtWG</span><span class="p">,</span> <span class="n">GtWd</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">include_sigma</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Gsub</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">trend_sigma</span><span class="p">[</span><span class="n">icomp</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">trend_sigma</span><span class="p">[</span><span class="n">icomp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinvh</span><span class="p">(</span><span class="n">GtWG</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">trend</span><span class="p">,</span> <span class="n">trend_sigma</span><span class="p">)</span> <span class="k">if</span> <span class="n">include_sigma</span> <span class="k">else</span> <span class="p">(</span><span class="n">trend</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Tobias Köhne.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>